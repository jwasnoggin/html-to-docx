!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("jszip"),require("xmlbuilder2"),require("html-to-vdom"),require("crypto"),require("fs"),require("path"),require("events"),require("color-name")):"function"==typeof define&&define.amd?define(["exports","jszip","xmlbuilder2","html-to-vdom","crypto","fs","path","events","color-name"],factory):factory((global="undefined"!=typeof globalThis?globalThis:global||self).HTMLToDOCX={},global.JSZip,global.xmlbuilder2,global.HTMLToVDOM,global.crypto,global.fs,global.path,global.events,global.colorNames)}(this,(function(exports,JSZip,xmlbuilder2,HTMLToVDOM,crypto,require$$0,require$$1$1,require$$1,colorNames){"use strict";function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var JSZip__default=_interopDefaultLegacy(JSZip),HTMLToVDOM__default=_interopDefaultLegacy(HTMLToVDOM),crypto__default=_interopDefaultLegacy(crypto),require$$0__default=_interopDefaultLegacy(require$$0),require$$1__default$1=_interopDefaultLegacy(require$$1$1),require$$1__default=_interopDefaultLegacy(require$$1),colorNames__default=_interopDefaultLegacy(colorNames),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var isVnode=function(x){return x&&"VirtualNode"===x.type&&"2"===x.version};var isVNode=isVnode,isWidget=function(w){return w&&"Widget"===w.type},isThunk=function(t){return t&&"Thunk"===t.type},isVHook=function(hook){return hook&&("function"==typeof hook.hook&&!hook.hasOwnProperty("hook")||"function"==typeof hook.unhook&&!hook.hasOwnProperty("unhook"))},vnode=VirtualNode,noProperties={},noChildren=[];function VirtualNode(tagName,properties,children,key,namespace){this.tagName=tagName,this.properties=properties||noProperties,this.children=children||noChildren,this.key=null!=key?String(key):void 0,this.namespace="string"==typeof namespace?namespace:null;var hooks,count=children&&children.length||0,descendants=0,hasWidgets=!1,hasThunks=!1,descendantHooks=!1;for(var propName in properties)if(properties.hasOwnProperty(propName)){var property=properties[propName];isVHook(property)&&property.unhook&&(hooks||(hooks={}),hooks[propName]=property)}for(var i=0;i<count;i++){var child=children[i];isVNode(child)?(descendants+=child.count||0,!hasWidgets&&child.hasWidgets&&(hasWidgets=!0),!hasThunks&&child.hasThunks&&(hasThunks=!0),descendantHooks||!child.hooks&&!child.descendantHooks||(descendantHooks=!0)):!hasWidgets&&isWidget(child)?"function"==typeof child.destroy&&(hasWidgets=!0):!hasThunks&&isThunk(child)&&(hasThunks=!0)}this.count=count+descendants,this.hasWidgets=hasWidgets,this.hasThunks=hasThunks,this.hooks=hooks,this.descendantHooks=descendantHooks}VirtualNode.prototype.version="2",VirtualNode.prototype.type="VirtualNode";var vtext=VirtualText;function VirtualText(text){this.text=String(text)}VirtualText.prototype.version="2",VirtualText.prototype.type="VirtualText";const namespaces_a="http://schemas.openxmlformats.org/drawingml/2006/main",namespaces_cdr="http://schemas.openxmlformats.org/drawingml/2006/chartDrawing",namespaces_dc="http://purl.org/dc/elements/1.1/",namespaces_dcmitype="http://purl.org/dc/dcmitype/",namespaces_dcterms="http://purl.org/dc/terms/",namespaces_o="urn:schemas-microsoft-com:office:office",namespaces_pic="http://schemas.openxmlformats.org/drawingml/2006/picture",namespaces_r="http://schemas.openxmlformats.org/officeDocument/2006/relationships",namespaces_v="urn:schemas-microsoft-com:vml",namespaces_ve="http://schemas.openxmlformats.org/markup-compatibility/2006",namespaces_vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",namespaces_w="http://schemas.openxmlformats.org/wordprocessingml/2006/main",namespaces_w10="urn:schemas-microsoft-com:office:word",namespaces_wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",namespaces_wne="http://schemas.microsoft.com/office/word/2006/wordml",namespaces_xsi="http://www.w3.org/2001/XMLSchema-instance",namespaces_numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",namespaces_hyperlinks="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",namespaces_images="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",namespaces_styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",namespaces_headers="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",namespaces_footers="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",namespaces_themes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",namespaces_coreProperties="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",namespaces_officeDocumentRelation="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",namespaces_corePropertiesRelation="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",namespaces_settingsRelation="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",namespaces_webSettingsRelation="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",namespaces_sl="http://schemas.openxmlformats.org/schemaLibrary/2006/main",namespaces_contentTypes="http://schemas.openxmlformats.org/package/2006/content-types",namespaces_relationship="http://schemas.openxmlformats.org/package/2006/relationships";function eq(value,other){return value===other||value!=value&&other!=other}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}var splice=Array.prototype.splice;function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=function(){this.__data__=[],this.size=0},ListCache.prototype.delete=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)},ListCache.prototype.get=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]},ListCache.prototype.has=function(key){return assocIndexOf(this.__data__,key)>-1},ListCache.prototype.set=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this};var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol=root.Symbol,objectProto$c=Object.prototype,hasOwnProperty$9=objectProto$c.hasOwnProperty,nativeObjectToString$1=objectProto$c.toString,symToStringTag$1=Symbol?Symbol.toStringTag:void 0;var nativeObjectToString=Object.prototype.toString;var symToStringTag=Symbol?Symbol.toStringTag:void 0;function baseGetTag(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag&&symToStringTag in Object(value)?function(value){var isOwn=hasOwnProperty$9.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString$1.call(value);return unmasked&&(isOwn?value[symToStringTag$1]=tag:delete value[symToStringTag$1]),result}(value):function(value){return nativeObjectToString.call(value)}(value)}function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}function isFunction(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag}var uid,coreJsData=root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";var funcToString$1=Function.prototype.toString;function toSource(func){if(null!=func){try{return funcToString$1.call(func)}catch(e){}try{return func+""}catch(e){}}return""}var reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$a=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$8=objectProto$a.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$8).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(value){return!(!isObject(value)||(func=value,maskSrcKey&&maskSrcKey in func))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value));var func}function getNative(object,key){var value=function(object,key){return null==object?void 0:object[key]}(object,key);return baseIsNative(value)?value:void 0}var Map$1=getNative(root,"Map"),nativeCreate=getNative(Object,"create");var hasOwnProperty$7=Object.prototype.hasOwnProperty;var hasOwnProperty$6=Object.prototype.hasOwnProperty;function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function getMapData(map,key){var value,type,data=map.__data__;return("string"==(type=typeof(value=key))||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value)?data["string"==typeof key?"string":"hash"]:data.map}function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0},Hash.prototype.delete=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result},Hash.prototype.get=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty$7.call(data,key)?data[key]:void 0},Hash.prototype.has=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty$6.call(data,key)},Hash.prototype.set=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this},MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}},MapCache.prototype.delete=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result},MapCache.prototype.get=function(key){return getMapData(this,key).get(key)},MapCache.prototype.has=function(key){return getMapData(this,key).has(key)},MapCache.prototype.set=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this};function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=function(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result},Stack.prototype.get=function(key){return this.__data__.get(key)},Stack.prototype.has=function(key){return this.__data__.has(key)},Stack.prototype.set=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map$1||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this};var defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();function baseAssignValue(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}var hasOwnProperty$5=Object.prototype.hasOwnProperty;function assignValue(object,key,value){var objValue=object[key];hasOwnProperty$5.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;void 0===newValue&&(newValue=source[key]),isNew?baseAssignValue(object,key,newValue):assignValue(object,key,newValue)}return object}function isObjectLike(value){return null!=value&&"object"==typeof value}function baseIsArguments(value){return isObjectLike(value)&&"[object Arguments]"==baseGetTag(value)}var objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty,propertyIsEnumerable$1=objectProto$6.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$4.call(value,"callee")&&!propertyIsEnumerable$1.call(value,"callee")},isArray=Array.isArray;var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,Buffer$2=freeModule$2&&freeModule$2.exports===freeExports$2?root.Buffer:void 0,isBuffer=(Buffer$2?Buffer$2.isBuffer:void 0)||function(){return!1},reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(value,length){var type=typeof value;return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}var typedArrayTags={};function baseUnary(func){return function(value){return func(value)}}typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,freeProcess=freeModule$1&&freeModule$1.exports===freeExports$1&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]},hasOwnProperty$3=Object.prototype.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty$3.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}var objectProto$4=Object.prototype;function isPrototype(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto$4)}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object),hasOwnProperty$2=Object.prototype.hasOwnProperty;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function keys$1(object){return isArrayLike(object)?arrayLikeKeys(object):function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty$2.call(object,key)&&"constructor"!=key&&result.push(key);return result}(object)}var hasOwnProperty$1=Object.prototype.hasOwnProperty;function baseKeysIn(object){if(!isObject(object))return function(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty$1.call(object,key))&&result.push(key);return result}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,Buffer$1=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function stubArray(){return[]}var propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(object){return null==object?[]:(object=Object(object),function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}(nativeGetSymbols$1(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)})))}:stubArray;function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}var getPrototype=overArg(Object.getPrototypeOf,Object),getSymbolsIn=Object.getOwnPropertySymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray;function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}function getAllKeys(object){return baseGetAllKeys(object,keys$1,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}var DataView=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set=getNative(root,"Set"),WeakMap=getNative(root,"WeakMap"),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&"[object DataView]"!=getTag(new DataView(new ArrayBuffer(1)))||Map$1&&"[object Map]"!=getTag(new Map$1)||Promise$1&&"[object Promise]"!=getTag(Promise$1.resolve())||Set&&"[object Set]"!=getTag(new Set)||WeakMap&&"[object WeakMap]"!=getTag(new WeakMap))&&(getTag=function(value){var result=baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result});var getTag$1=getTag,hasOwnProperty=Object.prototype.hasOwnProperty;var Uint8Array$1=root.Uint8Array;function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new Uint8Array$1(result).set(new Uint8Array$1(arrayBuffer)),result}var reFlags=/\w*$/;var symbolProto$1=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto$1?symbolProto$1.valueOf:void 0;function initCloneByTag(object,tag,isDeep){var symbol,regexp,result,Ctor=object.constructor;switch(tag){case"[object ArrayBuffer]":return cloneArrayBuffer(object);case"[object Boolean]":case"[object Date]":return new Ctor(+object);case"[object DataView]":return function(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}(object,isDeep);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}(object,isDeep);case"[object Map]":case"[object Set]":return new Ctor;case"[object Number]":case"[object String]":return new Ctor(object);case"[object RegExp]":return(result=new(regexp=object).constructor(regexp.source,reFlags.exec(regexp))).lastIndex=regexp.lastIndex,result;case"[object Symbol]":return symbol=object,symbolValueOf?Object(symbolValueOf.call(symbol)):{}}}var objectCreate=Object.create,baseCreate=function(){function object(){}return function(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=void 0,result}}();var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):function(value){return isObjectLike(value)&&"[object Map]"==getTag$1(value)};var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):function(value){return isObjectLike(value)&&"[object Set]"==getTag$1(value)},cloneableTags={};function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=1&bitmask,isFlat=2&bitmask,isFull=4&bitmask;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),void 0!==result)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=function(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}(value),!isDeep)return function(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}(value,result)}else{var tag=getTag$1(value),isFunc="[object Function]"==tag||"[object GeneratorFunction]"==tag;if(isBuffer(value))return function(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}(value,isDeep);if("[object Object]"==tag||"[object Arguments]"==tag||isFunc&&!object){if(result=isFlat||isFunc?{}:function(object){return"function"!=typeof object.constructor||isPrototype(object)?{}:baseCreate(getPrototype(object))}(value),!isDeep)return isFlat?function(source,object){return copyObject(source,getSymbolsIn(source),object)}(value,function(object,source){return object&&copyObject(source,keysIn(source),object)}(result,value)):function(source,object){return copyObject(source,getSymbols(source),object)}(value,function(object,source){return object&&copyObject(source,keys$1(source),object)}(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked)return stacked;stack.set(value,result),isSet(value)?value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))})):isMap(value)&&value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}));var props=isArr?void 0:(isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys$1)(value);return function(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););}(props||value,(function(subValue,key){props&&(subValue=value[key=subValue]),assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))})),result}cloneableTags["[object Arguments]"]=cloneableTags["[object Array]"]=cloneableTags["[object ArrayBuffer]"]=cloneableTags["[object DataView]"]=cloneableTags["[object Boolean]"]=cloneableTags["[object Date]"]=cloneableTags["[object Float32Array]"]=cloneableTags["[object Float64Array]"]=cloneableTags["[object Int8Array]"]=cloneableTags["[object Int16Array]"]=cloneableTags["[object Int32Array]"]=cloneableTags["[object Map]"]=cloneableTags["[object Number]"]=cloneableTags["[object Object]"]=cloneableTags["[object RegExp]"]=cloneableTags["[object Set]"]=cloneableTags["[object String]"]=cloneableTags["[object Symbol]"]=cloneableTags["[object Uint8Array]"]=cloneableTags["[object Uint8ClampedArray]"]=cloneableTags["[object Uint16Array]"]=cloneableTags["[object Uint32Array]"]=!0,cloneableTags["[object Error]"]=cloneableTags["[object Function]"]=cloneableTags["[object WeakMap]"]=!1;function cloneDeep(value){return baseClone(value,5)}const landscapeMargins={top:1800,right:1440,bottom:1800,left:1440,header:720,footer:720,gutter:0},portraitMargins={top:1440,right:1800,bottom:1440,left:1800,header:720,footer:720,gutter:0},defaultDocumentOptions={orientation:"portrait",margins:cloneDeep(portraitMargins),title:"",subject:"",creator:"html-to-docx",keywords:["html-to-docx"],description:"",lastModifiedBy:"html-to-docx",revision:1,createdAt:new Date,modifiedAt:new Date,headerType:"default",header:!1,footerType:"default",footer:!1,font:"Times New Roman",fontSize:22,complexScriptFontSize:22,table:{row:{cantSplit:!1}},pageNumber:!1,skipFirstHeaderFooter:!1,lineNumber:!1,lineNumberOptions:{countBy:1,start:0,restart:"continuous"}},paragraphBordersObject={top:{size:0,spacing:3,color:"FFFFFF"},left:{size:0,spacing:3,color:"FFFFFF"},bottom:{size:0,spacing:3,color:"FFFFFF"},right:{size:0,spacing:3,color:"FFFFFF"}},colorlessColors=["transparent","auto"],verticalAlignValues=["top","middle","bottom"],documentRelsXML=`\n  <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n  <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n    <Relationship Id="rId1" Type="${namespaces_numbering}" Target="numbering.xml"/>\n    <Relationship Id="rId2" Type="${namespaces_styles}" Target="styles.xml"/>\n    <Relationship Id="rId3" Type="${namespaces_settingsRelation}" Target="settings.xml"/>\n    <Relationship Id="rId4" Type="${namespaces_webSettingsRelation}" Target="webSettings.xml"/>\n  </Relationships>\n`,relsXML=`\n    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n        <Relationship Id="rId1" Type="${namespaces_officeDocumentRelation}" Target="word/document.xml"/>\n        <Relationship Id="rId2" Type="${namespaces_corePropertiesRelation}" Target="docProps/core.xml"/>\n    </Relationships>\n`,fontTableXML=`\n    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <w:fonts\n      xmlns:r="${namespaces_r}"\n      xmlns:w="${namespaces_w}"\n      >\n        <w:font w:name="Calibri">\n            <w:panose1 w:val="020F0502020204030204"/>\n            <w:charset w:val="00"/>\n            <w:family w:val="swiss"/>\n            <w:pitch w:val="variable"/>\n            <w:sig w:usb0="E4002EFF" w:usb1="C000247B" w:usb2="00000009" w:usb3="00000000" w:csb0="000001FF" w:csb1="00000000"/>\n        </w:font>\n        <w:font w:name="Times New Roman">\n            <w:panose1 w:val="02020603050405020304"/>\n            <w:charset w:val="00"/>\n            <w:family w:val="roman"/>\n            <w:pitch w:val="variable"/>\n            <w:sig w:usb0="E0002EFF" w:usb1="C000785B" w:usb2="00000009" w:usb3="00000000" w:csb0="000001FF" w:csb1="00000000"/>\n        </w:font>\n        <w:font w:name="Calibri Light">\n            <w:panose1 w:val="020F0302020204030204"/>\n            <w:charset w:val="00"/>\n            <w:family w:val="swiss"/>\n            <w:pitch w:val="variable"/>\n            <w:sig w:usb0="E4002EFF" w:usb1="C000247B" w:usb2="00000009" w:usb3="00000000" w:csb0="000001FF" w:csb1="00000000"/>\n        </w:font>\n    </w:fonts>\n`,settingsXML=`\n    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <w:settings xmlns:w="${namespaces_w}" xmlns:o="${namespaces_o}" xmlns:r="${namespaces_r}" xmlns:v="${namespaces_v}" xmlns:w10="${namespaces_w10}" xmlns:sl="${namespaces_sl}">\n        <w:zoom w:percent="100"/>\n        <w:defaultTabStop w:val="720"/>\n        <w:decimalSymbol w:val="."/>\n        <w:listSeparator w:val=","/>\n    </w:settings>\n`,webSettingsXML=`\n    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <w:webSettings xmlns:w="${namespaces_w}" xmlns:r="${namespaces_r}">\n    </w:webSettings>\n`;let pool,poolOffset,nanoid=(size=21)=>{var bytes;bytes=size-=0,!pool||pool.length<bytes?(pool=Buffer.allocUnsafe(128*bytes),crypto__default.default.randomFillSync(pool),poolOffset=0):poolOffset+bytes>pool.length&&(crypto__default.default.randomFillSync(pool),poolOffset=0),poolOffset+=bytes;let id="";for(let i=poolOffset-size;i<poolOffset;i++)id+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&pool[i]];return id};var isVtext=function(x){return x&&"VirtualText"===x.type&&"2"===x.version};const{replace:replace}="",ca=/[&<>'"]/g,esca={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},pe=m=>esca[m],vNodeHasChildren=vNode=>vNode&&vNode.children&&Array.isArray(vNode.children)&&vNode.children.length;var dist={exports:{}},queue={exports:{}},inherits$1={exports:{}},inherits_browser={exports:{}};"function"==typeof Object.create?inherits_browser.exports=function(ctor,superCtor){superCtor&&(ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}};try{var util=require("util");if("function"!=typeof util.inherits)throw"";inherits$1.exports=util.inherits}catch(e){inherits$1.exports=inherits_browser.exports}var inherits=inherits$1.exports,EventEmitter=require$$1__default.default.EventEmitter;function Queue(options){if(!(this instanceof Queue))return new Queue(options);EventEmitter.call(this),options=options||{},this.concurrency=options.concurrency||1/0,this.timeout=options.timeout||0,this.autostart=options.autostart||!1,this.results=options.results||null,this.pending=0,this.session=0,this.running=!1,this.jobs=[],this.timers={}}queue.exports=Queue,queue.exports.default=Queue,inherits(Queue,EventEmitter);["pop","shift","indexOf","lastIndexOf"].forEach((function(method){Queue.prototype[method]=function(){return Array.prototype[method].apply(this.jobs,arguments)}})),Queue.prototype.slice=function(begin,end){return this.jobs=this.jobs.slice(begin,end),this},Queue.prototype.reverse=function(){return this.jobs.reverse(),this};function clearTimers(){for(var key in this.timers){var timeoutId=this.timers[key];delete this.timers[key],clearTimeout(timeoutId)}}function callOnErrorOrEnd(cb){var self=this;function onerror(err){self.end(err)}this.on("error",onerror),this.on("end",(function onend(err){self.removeListener("error",onerror),self.removeListener("end",onend),cb(err,this.results)}))}function done(err){this.session++,this.running=!1,this.emit("end",err)}["push","unshift","splice"].forEach((function(method){Queue.prototype[method]=function(){var methodResult=Array.prototype[method].apply(this.jobs,arguments);return this.autostart&&this.start(),methodResult}})),Object.defineProperty(Queue.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),Queue.prototype.start=function(cb){if(cb&&callOnErrorOrEnd.call(this,cb),this.running=!0,!(this.pending>=this.concurrency))if(0!==this.jobs.length){var self=this,job=this.jobs.shift(),once=!0,session=this.session,timeoutId=null,didTimeout=!1,resultIndex=null,timeout=job.hasOwnProperty("timeout")?job.timeout:this.timeout;timeout&&(timeoutId=setTimeout((function(){didTimeout=!0,self.listeners("timeout").length>0?self.emit("timeout",next,job):next()}),timeout),this.timers[timeoutId]=timeoutId),this.results&&(resultIndex=this.results.length,this.results[resultIndex]=null),this.pending++,self.emit("start",job);var promise=job(next);promise&&promise.then&&"function"==typeof promise.then&&promise.then((function(result){return next(null,result)})).catch((function(err){return next(err||!0)})),this.running&&this.jobs.length>0&&this.start()}else 0===this.pending&&done.call(this);function next(err,result){once&&self.session===session&&(once=!1,self.pending--,null!==timeoutId&&(delete self.timers[timeoutId],clearTimeout(timeoutId)),err?self.emit("error",err,job):!1===didTimeout&&(null!==resultIndex&&(self.results[resultIndex]=Array.prototype.slice.call(arguments,1)),self.emit("success",result,job)),self.session===session&&(0===self.pending&&0===self.jobs.length?done.call(self):self.running&&self.start()))}},Queue.prototype.stop=function(){this.running=!1},Queue.prototype.end=function(err){clearTimers.call(this),this.jobs.length=0,this.pending=0,done.call(this,err)};var types={},bmp={};Object.defineProperty(bmp,"__esModule",{value:!0}),bmp.BMP=void 0,bmp.BMP={validate:buffer=>"BM"===buffer.toString("ascii",0,2),calculate:buffer=>({height:Math.abs(buffer.readInt32LE(22)),width:buffer.readUInt32LE(18)})};var cur={},ico={};Object.defineProperty(ico,"__esModule",{value:!0}),ico.ICO=void 0;function getSizeFromOffset(buffer,offset){const value=buffer.readUInt8(offset);return 0===value?256:value}function getImageSize$1(buffer,imageIndex){const offset=6+16*imageIndex;return{height:getSizeFromOffset(buffer,offset+1),width:getSizeFromOffset(buffer,offset)}}ico.ICO={validate:buffer=>0===buffer.readUInt16LE(0)&&1===buffer.readUInt16LE(2),calculate(buffer){const nbImages=buffer.readUInt16LE(4),imageSize=getImageSize$1(buffer,0);if(1===nbImages)return imageSize;const imgs=[imageSize];for(let imageIndex=1;imageIndex<nbImages;imageIndex+=1)imgs.push(getImageSize$1(buffer,imageIndex));return{height:imageSize.height,images:imgs,width:imageSize.width}}},Object.defineProperty(cur,"__esModule",{value:!0}),cur.CUR=void 0;const ico_1$1=ico;cur.CUR={validate:buffer=>0===buffer.readUInt16LE(0)&&2===buffer.readUInt16LE(2),calculate:buffer=>ico_1$1.ICO.calculate(buffer)};var dds={};Object.defineProperty(dds,"__esModule",{value:!0}),dds.DDS=void 0,dds.DDS={validate:buffer=>542327876===buffer.readUInt32LE(0),calculate:buffer=>({height:buffer.readUInt32LE(12),width:buffer.readUInt32LE(16)})};var gif={};Object.defineProperty(gif,"__esModule",{value:!0}),gif.GIF=void 0;const gifRegexp=/^GIF8[79]a/;gif.GIF={validate(buffer){const signature=buffer.toString("ascii",0,6);return gifRegexp.test(signature)},calculate:buffer=>({height:buffer.readUInt16LE(8),width:buffer.readUInt16LE(6)})};var icns={};Object.defineProperty(icns,"__esModule",{value:!0}),icns.ICNS=void 0;const ICON_TYPE_SIZE={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function readImageHeader(buffer,imageOffset){const imageLengthOffset=imageOffset+4;return[buffer.toString("ascii",imageOffset,imageLengthOffset),buffer.readUInt32BE(imageLengthOffset)]}function getImageSize(type){const size=ICON_TYPE_SIZE[type];return{width:size,height:size,type:type}}icns.ICNS={validate:buffer=>"icns"===buffer.toString("ascii",0,4),calculate(buffer){const bufferLength=buffer.length,fileLength=buffer.readUInt32BE(4);let imageOffset=8,imageHeader=readImageHeader(buffer,imageOffset),imageSize=getImageSize(imageHeader[0]);if(imageOffset+=imageHeader[1],imageOffset===fileLength)return imageSize;const result={height:imageSize.height,images:[imageSize],width:imageSize.width};for(;imageOffset<fileLength&&imageOffset<bufferLength;)imageHeader=readImageHeader(buffer,imageOffset),imageSize=getImageSize(imageHeader[0]),imageOffset+=imageHeader[1],result.images.push(imageSize);return result}};var j2c={};Object.defineProperty(j2c,"__esModule",{value:!0}),j2c.J2C=void 0,j2c.J2C={validate:buffer=>"ff4fff51"===buffer.toString("hex",0,4),calculate:buffer=>({height:buffer.readUInt32BE(12),width:buffer.readUInt32BE(8)})};var jp2={};Object.defineProperty(jp2,"__esModule",{value:!0}),jp2.JP2=void 0;const BoxTypes_ftyp="66747970",BoxTypes_jp2h="6a703268",BoxTypes_jp__="6a502020",BoxTypes_rreq="72726571",parseIHDR=box=>({height:box.readUInt32BE(4),width:box.readUInt32BE(8)});jp2.JP2={validate(buffer){const signature=buffer.toString("hex",4,8),signatureLength=buffer.readUInt32BE(0);if(signature!==BoxTypes_jp__||signatureLength<1)return!1;const ftypeBoxStart=signatureLength+4,ftypBoxLength=buffer.readUInt32BE(signatureLength);return buffer.slice(ftypeBoxStart,ftypeBoxStart+ftypBoxLength).toString("hex",0,4)===BoxTypes_ftyp},calculate(buffer){const signatureLength=buffer.readUInt32BE(0);let offset=signatureLength+4+buffer.readUInt16BE(signatureLength+2);switch(buffer.toString("hex",offset,offset+4)){case BoxTypes_rreq:return offset=offset+4+4+(box=>{const unit=box.readUInt8(0);let offset=1+2*unit;return offset=offset+2+box.readUInt16BE(offset)*(2+unit),offset+2+box.readUInt16BE(offset)*(16+unit)})(buffer.slice(offset+4)),parseIHDR(buffer.slice(offset+8,offset+24));case BoxTypes_jp2h:return parseIHDR(buffer.slice(offset+8,offset+24));default:throw new TypeError("Unsupported header found: "+buffer.toString("ascii",offset,offset+4))}}};var jpg={},readUInt$1={};Object.defineProperty(readUInt$1,"__esModule",{value:!0}),readUInt$1.readUInt=void 0,readUInt$1.readUInt=function(buffer,bits,offset,isBigEndian){return offset=offset||0,buffer["readUInt"+bits+(isBigEndian?"BE":"LE")].call(buffer,offset)},Object.defineProperty(jpg,"__esModule",{value:!0}),jpg.JPG=void 0;const readUInt_1$1=readUInt$1;function isEXIF(buffer){return"45786966"===buffer.toString("hex",2,6)}function extractSize(buffer,index){return{height:buffer.readUInt16BE(index),width:buffer.readUInt16BE(index+2)}}function validateExifBlock(buffer,index){const exifBlock=buffer.slice(2,index),byteAlign=exifBlock.toString("hex",6,8),isBigEndian="4d4d"===byteAlign;if(isBigEndian||"4949"===byteAlign)return function(exifBlock,isBigEndian){const idfDirectoryEntries=(0,readUInt_1$1.readUInt)(exifBlock,16,14,isBigEndian);for(let directoryEntryNumber=0;directoryEntryNumber<idfDirectoryEntries;directoryEntryNumber++){const start=16+12*directoryEntryNumber,end=start+12;if(start>exifBlock.length)return;const block=exifBlock.slice(start,end);if(274===(0,readUInt_1$1.readUInt)(block,16,0,isBigEndian)){if(3!==(0,readUInt_1$1.readUInt)(block,16,2,isBigEndian))return;if(1!==(0,readUInt_1$1.readUInt)(block,32,4,isBigEndian))return;return(0,readUInt_1$1.readUInt)(block,16,8,isBigEndian)}}}(exifBlock,isBigEndian)}function validateBuffer(buffer,index){if(index>buffer.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(255!==buffer[index])throw new TypeError("Invalid JPG, marker table corrupted")}jpg.JPG={validate:buffer=>"ffd8"===buffer.toString("hex",0,2),calculate(buffer){let orientation,next;for(buffer=buffer.slice(4);buffer.length;){const i=buffer.readUInt16BE(0);if(isEXIF(buffer)&&(orientation=validateExifBlock(buffer,i)),validateBuffer(buffer,i),next=buffer[i+1],192===next||193===next||194===next){const size=extractSize(buffer,i+5);return orientation?{height:size.height,orientation:orientation,width:size.width}:size}buffer=buffer.slice(i+2)}throw new TypeError("Invalid JPG, no size found")}};var ktx={};Object.defineProperty(ktx,"__esModule",{value:!0}),ktx.KTX=void 0;ktx.KTX={validate:buffer=>"KTX 11"===buffer.toString("ascii",1,7),calculate:buffer=>({height:buffer.readUInt32LE(40),width:buffer.readUInt32LE(36)})};var png={};Object.defineProperty(png,"__esModule",{value:!0}),png.PNG=void 0;png.PNG={validate(buffer){if("PNG\r\n\n"===buffer.toString("ascii",1,8)){let chunkName=buffer.toString("ascii",12,16);if("CgBI"===chunkName&&(chunkName=buffer.toString("ascii",28,32)),"IHDR"!==chunkName)throw new TypeError("Invalid PNG");return!0}return!1},calculate:buffer=>"CgBI"===buffer.toString("ascii",12,16)?{height:buffer.readUInt32BE(36),width:buffer.readUInt32BE(32)}:{height:buffer.readUInt32BE(20),width:buffer.readUInt32BE(16)}};var pnm={};Object.defineProperty(pnm,"__esModule",{value:!0}),pnm.PNM=void 0;const PNMTypes={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},Signatures=Object.keys(PNMTypes),handlers={default:lines=>{let dimensions=[];for(;lines.length>0;){const line=lines.shift();if("#"!==line[0]){dimensions=line.split(" ");break}}if(2===dimensions.length)return{height:parseInt(dimensions[1],10),width:parseInt(dimensions[0],10)};throw new TypeError("Invalid PNM")},pam:lines=>{const size={};for(;lines.length>0;){const line=lines.shift();if(line.length>16||line.charCodeAt(0)>128)continue;const[key,value]=line.split(" ");if(key&&value&&(size[key.toLowerCase()]=parseInt(value,10)),size.height&&size.width)break}if(size.height&&size.width)return{height:size.height,width:size.width};throw new TypeError("Invalid PAM")}};pnm.PNM={validate(buffer){const signature=buffer.toString("ascii",0,2);return Signatures.includes(signature)},calculate(buffer){const signature=buffer.toString("ascii",0,2),type=PNMTypes[signature],lines=buffer.toString("ascii",3).split(/[\r\n]+/);return(handlers[type]||handlers.default)(lines)}};var psd={};Object.defineProperty(psd,"__esModule",{value:!0}),psd.PSD=void 0,psd.PSD={validate:buffer=>"8BPS"===buffer.toString("ascii",0,4),calculate:buffer=>({height:buffer.readUInt32BE(14),width:buffer.readUInt32BE(18)})};var svg={};Object.defineProperty(svg,"__esModule",{value:!0}),svg.SVG=void 0;const svgReg=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,extractorRegExps={height:/\sheight=(['"])([^%]+?)\1/,root:svgReg,viewbox:/\sviewBox=(['"])(.+?)\1/i,width:/\swidth=(['"])([^%]+?)\1/},units={in:96,cm:96/2.54,em:16,ex:8,m:96/2.54*100,mm:96/2.54/10,pc:96/72/12,pt:96/72,px:1},unitsReg=new RegExp(`^([0-9.]+(?:e\\d+)?)(${Object.keys(units).join("|")})?$`);function parseLength(len){const m=unitsReg.exec(len);if(m)return Math.round(Number(m[1])*(units[m[2]]||1))}function parseViewbox(viewbox){const bounds=viewbox.split(" ");return{height:parseLength(bounds[3]),width:parseLength(bounds[2])}}svg.SVG={validate(buffer){const str=String(buffer);return svgReg.test(str)},calculate(buffer){const root=buffer.toString("utf8").match(extractorRegExps.root);if(root){const attrs=function(root){const width=root.match(extractorRegExps.width),height=root.match(extractorRegExps.height),viewbox=root.match(extractorRegExps.viewbox);return{height:height&&parseLength(height[2]),viewbox:viewbox&&parseViewbox(viewbox[2]),width:width&&parseLength(width[2])}}(root[0]);if(attrs.width&&attrs.height)return function(attrs){return{height:attrs.height,width:attrs.width}}(attrs);if(attrs.viewbox)return function(attrs,viewbox){const ratio=viewbox.width/viewbox.height;return attrs.width?{height:Math.floor(attrs.width/ratio),width:attrs.width}:attrs.height?{height:attrs.height,width:Math.floor(attrs.height*ratio)}:{height:viewbox.height,width:viewbox.width}}(attrs,attrs.viewbox)}throw new TypeError("Invalid SVG")}};var tiff={};Object.defineProperty(tiff,"__esModule",{value:!0}),tiff.TIFF=void 0;const fs=require$$0__default.default,readUInt_1=readUInt$1;function readValue(buffer,isBigEndian){const low=(0,readUInt_1.readUInt)(buffer,16,8,isBigEndian);return((0,readUInt_1.readUInt)(buffer,16,10,isBigEndian)<<16)+low}function nextTag(buffer){if(buffer.length>24)return buffer.slice(12)}const signatures=["49492a00","4d4d002a"];tiff.TIFF={validate:buffer=>signatures.includes(buffer.toString("hex",0,4)),calculate(buffer,filepath){if(!filepath)throw new TypeError("Tiff doesn't support buffer");const isBigEndian="BE"===function(buffer){const signature=buffer.toString("ascii",0,2);return"II"===signature?"LE":"MM"===signature?"BE":void 0}(buffer),ifdBuffer=function(buffer,filepath,isBigEndian){const ifdOffset=(0,readUInt_1.readUInt)(buffer,32,4,isBigEndian);let bufferSize=1024;const fileSize=fs.statSync(filepath).size;ifdOffset+bufferSize>fileSize&&(bufferSize=fileSize-ifdOffset-10);const endBuffer=Buffer.alloc(bufferSize),descriptor=fs.openSync(filepath,"r");return fs.readSync(descriptor,endBuffer,0,bufferSize,ifdOffset),fs.closeSync(descriptor),endBuffer.slice(2)}(buffer,filepath,isBigEndian),tags=function(buffer,isBigEndian){const tags={};let temp=buffer;for(;temp&&temp.length;){const code=(0,readUInt_1.readUInt)(temp,16,0,isBigEndian),type=(0,readUInt_1.readUInt)(temp,16,2,isBigEndian),length=(0,readUInt_1.readUInt)(temp,32,4,isBigEndian);if(0===code)break;1!==length||3!==type&&4!==type||(tags[code]=readValue(temp,isBigEndian)),temp=nextTag(temp)}return tags}(ifdBuffer,isBigEndian),width=tags[256],height=tags[257];if(!width||!height)throw new TypeError("Invalid Tiff. Missing tags");return{height:height,width:width}}};var webp={};Object.defineProperty(webp,"__esModule",{value:!0}),webp.WEBP=void 0,webp.WEBP={validate(buffer){const riffHeader="RIFF"===buffer.toString("ascii",0,4),webpHeader="WEBP"===buffer.toString("ascii",8,12),vp8Header="VP8"===buffer.toString("ascii",12,15);return riffHeader&&webpHeader&&vp8Header},calculate(buffer){const chunkHeader=buffer.toString("ascii",12,16);if(buffer=buffer.slice(20,30),"VP8X"===chunkHeader){const extendedHeader=buffer[0],validEnd=0==(1&extendedHeader);if(0==(192&extendedHeader)&&validEnd)return function(buffer){return{height:1+buffer.readUIntLE(7,3),width:1+buffer.readUIntLE(4,3)}}(buffer);throw new TypeError("Invalid WebP")}if("VP8 "===chunkHeader&&47!==buffer[0])return function(buffer){return{height:16383&buffer.readInt16LE(8),width:16383&buffer.readInt16LE(6)}}(buffer);const signature=buffer.toString("hex",3,6);if("VP8L"===chunkHeader&&"9d012a"!==signature)return function(buffer){return{height:1+((15&buffer[4])<<10|buffer[3]<<2|(192&buffer[2])>>6),width:1+((63&buffer[2])<<8|buffer[1])}}(buffer);throw new TypeError("Invalid WebP")}},Object.defineProperty(types,"__esModule",{value:!0}),types.typeHandlers=void 0;const bmp_1=bmp,cur_1=cur,dds_1=dds,gif_1=gif,icns_1=icns,ico_1=ico,j2c_1=j2c,jp2_1=jp2,jpg_1=jpg,ktx_1=ktx,png_1=png,pnm_1=pnm,psd_1=psd,svg_1=svg,tiff_1=tiff,webp_1=webp;types.typeHandlers={bmp:bmp_1.BMP,cur:cur_1.CUR,dds:dds_1.DDS,gif:gif_1.GIF,icns:icns_1.ICNS,ico:ico_1.ICO,j2c:j2c_1.J2C,jp2:jp2_1.JP2,jpg:jpg_1.JPG,ktx:ktx_1.KTX,png:png_1.PNG,pnm:pnm_1.PNM,psd:psd_1.PSD,svg:svg_1.SVG,tiff:tiff_1.TIFF,webp:webp_1.WEBP};var detector$1={};Object.defineProperty(detector$1,"__esModule",{value:!0}),detector$1.detector=void 0;const types_1=types,keys=Object.keys(types_1.typeHandlers),firstBytes={56:"psd",66:"bmp",68:"dds",71:"gif",73:"tiff",77:"tiff",82:"webp",105:"icns",137:"png",255:"jpg"};detector$1.detector=function(buffer){const byte=buffer[0];if(byte in firstBytes){const type=firstBytes[byte];if(type&&types_1.typeHandlers[type].validate(buffer))return type}return keys.find((key=>types_1.typeHandlers[key].validate(buffer)))},function(module,exports){var __awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.types=exports.setConcurrency=exports.disableTypes=exports.disableFS=exports.imageSize=void 0;const fs=require$$0__default.default,path=require$$1__default$1.default,queue_1=queue.exports,types_1=types,detector_1=detector$1,queue$1=new queue_1.default({concurrency:100,autostart:!0}),globalOptions={disabledFS:!1,disabledTypes:[]};function lookup(buffer,filepath){const type=(0,detector_1.detector)(buffer);if(void 0!==type){if(globalOptions.disabledTypes.indexOf(type)>-1)throw new TypeError("disabled file type: "+type);if(type in types_1.typeHandlers){const size=types_1.typeHandlers[type].calculate(buffer,filepath);if(void 0!==size)return size.type=type,size}}throw new TypeError("unsupported file type: "+type+" (file: "+filepath+")")}function imageSize(input,callback){if(Buffer.isBuffer(input))return lookup(input);if("string"!=typeof input||globalOptions.disabledFS)throw new TypeError("invalid invocation. input should be a Buffer");const filepath=path.resolve(input);if("function"!=typeof callback){const buffer=function(filepath){const descriptor=fs.openSync(filepath,"r");try{const{size:size}=fs.fstatSync(descriptor);if(size<=0)throw new Error("Empty file");const bufferSize=Math.min(size,524288),buffer=Buffer.alloc(bufferSize);return fs.readSync(descriptor,buffer,0,bufferSize,0),buffer}finally{fs.closeSync(descriptor)}}(filepath);return lookup(buffer,filepath)}queue$1.push((()=>function(filepath){return __awaiter(this,void 0,void 0,(function*(){const handle=yield fs.promises.open(filepath,"r");try{const{size:size}=yield handle.stat();if(size<=0)throw new Error("Empty file");const bufferSize=Math.min(size,524288),buffer=Buffer.alloc(bufferSize);return yield handle.read(buffer,0,bufferSize,0),buffer}finally{yield handle.close()}}))}(filepath).then((buffer=>process.nextTick(callback,null,lookup(buffer,filepath)))).catch(callback)))}module.exports=exports=imageSize,exports.default=imageSize,exports.imageSize=imageSize;exports.disableFS=v=>{globalOptions.disabledFS=v};exports.disableTypes=types=>{globalOptions.disabledTypes=types};exports.setConcurrency=c=>{queue$1.concurrency=c},exports.types=Object.keys(types_1.typeHandlers)}(dist,dist.exports);var sizeOf=getDefaultExportFromCjs(dist.exports);const pixelRegex=/([\d.]+)px/i,percentageRegex=/([\d.]+)%/i,pointRegex=/(\d+)pt/i,cmRegex=/([\d.]+)cm/i,inchRegex=/([\d.]+)in/i,pixelToEMU=pixelValue=>Math.round(9525*pixelValue),EMUToTWIP=EMUValue=>Math.round(EMUValue/635),pointToTWIP=pointValue=>Math.round(20*pointValue),pointToHIP=pointValue=>Math.round(2*pointValue),pixelToTWIP=pixelValue=>EMUToTWIP(pixelToEMU(pixelValue)),pixelToHIP=pixelValue=>{return TWIPValue=EMUToTWIP(pixelToEMU(pixelValue)),Math.round(TWIPValue/10);var TWIPValue},inchToTWIP=inchValue=>pointToTWIP((inchValue=>Math.round(72*inchValue))(inchValue)),pixelToPoint=pixelValue=>{return HIPValue=pixelToHIP(pixelValue),Math.round(HIPValue/2);var HIPValue},pointToEIP=PointValue=>Math.round(8*PointValue);function computeImageDimensions(vNode,attributes){const{maximumWidth:maximumWidth,originalWidth:originalWidth,originalHeight:originalHeight}=attributes,aspectRatio=originalWidth/originalHeight,maximumWidthInEMU=(TWIPValue=maximumWidth,Math.round(635*TWIPValue));var TWIPValue;let modifiedHeight,modifiedWidth,originalWidthInEMU=pixelToEMU(originalWidth),originalHeightInEMU=pixelToEMU(originalHeight);if(originalWidthInEMU>maximumWidthInEMU&&(originalWidthInEMU=maximumWidthInEMU,originalHeightInEMU=Math.round(originalWidthInEMU/aspectRatio)),vNode.properties&&vNode.properties.style){if(vNode.properties.style.width)if("auto"!==vNode.properties.style.width){if(pixelRegex.test(vNode.properties.style.width))modifiedWidth=pixelToEMU(vNode.properties.style.width.match(pixelRegex)[1]);else if(percentageRegex.test(vNode.properties.style.width)){const percentageValue=vNode.properties.style.width.match(percentageRegex)[1];modifiedWidth=Math.round(percentageValue/100*originalWidthInEMU)}}else vNode.properties.style.height&&"auto"===vNode.properties.style.height&&(modifiedWidth=originalWidthInEMU,modifiedHeight=originalHeightInEMU);if(vNode.properties.style.height)if("auto"!==vNode.properties.style.height){if(pixelRegex.test(vNode.properties.style.height))modifiedHeight=pixelToEMU(vNode.properties.style.height.match(pixelRegex)[1]);else if(percentageRegex.test(vNode.properties.style.height)){const percentageValue=vNode.properties.style.width.match(percentageRegex)[1];modifiedHeight=Math.round(percentageValue/100*originalHeightInEMU),modifiedWidth||(modifiedWidth=Math.round(modifiedHeight*aspectRatio))}}else modifiedWidth?modifiedHeight||(modifiedHeight=Math.round(modifiedWidth/aspectRatio)):(modifiedHeight=originalHeightInEMU,modifiedWidth=originalWidthInEMU);modifiedWidth&&!modifiedHeight?modifiedHeight=Math.round(modifiedWidth/aspectRatio):modifiedHeight&&!modifiedWidth&&(modifiedWidth=Math.round(modifiedHeight*aspectRatio))}else modifiedWidth=originalWidthInEMU,modifiedHeight=originalHeightInEMU;attributes.width=modifiedWidth,attributes.height=modifiedHeight}
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function buildExtent({width:width,height:height}){return xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","extent").att("cx",width).att("cy",height).up()}function buildEffectExtentFragment(){return xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","effectExtent").att("b","0").att("l","0").att("r","0").att("t","0").up()}function buildDrawingObjectNonVisualProperties(pictureId,pictureName){return xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","docPr").att("id",pictureId).att("name",pictureName).up()}function buildGraphicFrameTransform(attributes){const graphicFrameTransformFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","xfrm"),offsetFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","off").att("x","0").att("y","0").up();graphicFrameTransformFragment.import(offsetFragment);const extentsFragment=function({width:width,height:height}){return xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","ext").att("cx",width).att("cy",height).up()}(attributes);return graphicFrameTransformFragment.import(extentsFragment),graphicFrameTransformFragment.up(),graphicFrameTransformFragment}function buildShapeProperties(attributes){const shapeProperties=xmlbuilder2.fragment({namespaceAlias:{pic:namespaces_pic}}).ele("@pic","spPr"),graphicFrameTransformFragment=buildGraphicFrameTransform(attributes);shapeProperties.import(graphicFrameTransformFragment);const presetGeometryFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","prstGeom").att("prst","rect").up();return shapeProperties.import(presetGeometryFragment),shapeProperties.up(),shapeProperties}function buildStretch(){const stretchFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","stretch"),fillRectFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","fillRect").up();return stretchFragment.import(fillRectFragment),stretchFragment.up(),stretchFragment}function buildBinaryLargeImageOrPictureFill(relationshipId){const binaryLargeImageOrPictureFillFragment=xmlbuilder2.fragment({namespaceAlias:{pic:namespaces_pic}}).ele("@pic","blipFill"),binaryLargeImageOrPictureFragment=function(relationshipId){return xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a,r:namespaces_r}}).ele("@a","a:blip").att("@r","r:embed",`rId${relationshipId}`).att("cstate","print").up()}(relationshipId);binaryLargeImageOrPictureFillFragment.import(binaryLargeImageOrPictureFragment);const srcRectFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","srcRect").att("b","0").att("l","0").att("r","0").att("t","0").up();binaryLargeImageOrPictureFillFragment.import(srcRectFragment);const stretchFragment=buildStretch();return binaryLargeImageOrPictureFillFragment.import(stretchFragment),binaryLargeImageOrPictureFillFragment.up(),binaryLargeImageOrPictureFillFragment}function buildNonVisualPictureProperties(pictureId,pictureNameWithExtension,pictureDescription){const nonVisualPicturePropertiesFragment=xmlbuilder2.fragment({namespaceAlias:{pic:namespaces_pic}}).ele("@pic","nvPicPr"),nonVisualDrawingPropertiesFragment=function(pictureId,pictureNameWithExtension,pictureDescription=""){return xmlbuilder2.fragment({namespaceAlias:{pic:namespaces_pic}}).ele("@pic","cNvPr").att("id",pictureId).att("name",pictureNameWithExtension).att("descr",pictureDescription).up()}(pictureId,pictureNameWithExtension,pictureDescription);nonVisualPicturePropertiesFragment.import(nonVisualDrawingPropertiesFragment);const nonVisualPictureDrawingPropertiesFragment=xmlbuilder2.fragment({namespaceAlias:{pic:namespaces_pic}}).ele("@pic","cNvPicPr").up();return nonVisualPicturePropertiesFragment.import(nonVisualPictureDrawingPropertiesFragment),nonVisualPicturePropertiesFragment.up(),nonVisualPicturePropertiesFragment}function buildGraphicData(graphicType,attributes){const graphicDataFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","graphicData").att("uri","http://schemas.openxmlformats.org/drawingml/2006/picture");if("picture"===graphicType){const pictureFragment=function({id:id,fileNameWithExtension:fileNameWithExtension,description:description,relationshipId:relationshipId,width:width,height:height}){const pictureFragment=xmlbuilder2.fragment({namespaceAlias:{pic:namespaces_pic}}).ele("@pic","pic:pic"),nonVisualPicturePropertiesFragment=buildNonVisualPictureProperties(id,fileNameWithExtension,description);pictureFragment.import(nonVisualPicturePropertiesFragment);const binaryLargeImageOrPictureFill=buildBinaryLargeImageOrPictureFill(relationshipId);pictureFragment.import(binaryLargeImageOrPictureFill);const shapeProperties=buildShapeProperties({width:width,height:height});return pictureFragment.import(shapeProperties),pictureFragment.up(),pictureFragment}(attributes);graphicDataFragment.import(pictureFragment)}return graphicDataFragment.up(),graphicDataFragment}function buildGraphic(graphicType,attributes){const graphicFragment=xmlbuilder2.fragment({namespaceAlias:{a:namespaces_a}}).ele("@a","graphic"),graphicDataFragment=buildGraphicData(graphicType,attributes);return graphicFragment.import(graphicDataFragment),graphicFragment.up(),graphicFragment}function buildAnchoredDrawing(graphicType,attributes){const anchoredDrawingFragment=xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","anchor").att("distB","0").att("distL","0").att("distR","0").att("distT","0").att("relativeHeight","0").att("behindDoc","false").att("locked","true").att("layoutInCell","true").att("allowOverlap","false").att("simplePos","false"),simplePosFragment=xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","simplePos").att("x","0").att("y","0").up();anchoredDrawingFragment.import(simplePosFragment);const positionHFragment=xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","positionH").att("relativeFrom","column").ele("@wp","posOffset").txt("19050").up().up();anchoredDrawingFragment.import(positionHFragment);const positionVFragment=xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","positionV").att("relativeFrom","paragraph").ele("@wp","posOffset").txt("19050").up().up();anchoredDrawingFragment.import(positionVFragment);const extentFragment=buildExtent({width:attributes.width,height:attributes.height});anchoredDrawingFragment.import(extentFragment);const effectExtentFragment=buildEffectExtentFragment();anchoredDrawingFragment.import(effectExtentFragment);const wrapSquareFragment=xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","wrapSquare").att("wrapText","bothSides").att("distB","228600").att("distT","228600").att("distL","228600").att("distR","228600").up();anchoredDrawingFragment.import(wrapSquareFragment);const drawingObjectNonVisualPropertiesFragment=buildDrawingObjectNonVisualProperties(attributes.id,attributes.fileNameWithExtension);anchoredDrawingFragment.import(drawingObjectNonVisualPropertiesFragment);const graphicFragment=buildGraphic(graphicType,attributes);return anchoredDrawingFragment.import(graphicFragment),anchoredDrawingFragment.up(),anchoredDrawingFragment}function buildDrawing(inlineOrAnchored=!1,graphicType,attributes){const drawingFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","drawing"),inlineOrAnchoredDrawingFragment=inlineOrAnchored?function(graphicType,attributes){const inlineDrawingFragment=xmlbuilder2.fragment({namespaceAlias:{wp:namespaces_wp}}).ele("@wp","wp:inline").att("distB","0").att("distL","0").att("distR","0").att("distT","0"),extentFragment=buildExtent({width:attributes.width,height:attributes.height});inlineDrawingFragment.import(extentFragment);const effectExtentFragment=buildEffectExtentFragment();inlineDrawingFragment.import(effectExtentFragment);const drawingObjectNonVisualPropertiesFragment=buildDrawingObjectNonVisualProperties(attributes.id,attributes.fileNameWithExtension);inlineDrawingFragment.import(drawingObjectNonVisualPropertiesFragment);const graphicFragment=buildGraphic(graphicType,attributes);return inlineDrawingFragment.import(graphicFragment),inlineDrawingFragment.up(),inlineDrawingFragment}(graphicType,attributes):buildAnchoredDrawing(graphicType,attributes);return drawingFragment.import(inlineOrAnchoredDrawingFragment),drawingFragment.up(),drawingFragment}function buildTextElement(text){return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","t").att("@xml","space","preserve").txt(text).up()}const buildBold=()=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","b").up(),buildItalics=()=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","i").up(),buildUnderline=(type="single")=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","u").att("@w","val",type).up(),buildRunFontFragment=(fontName="Times New Roman")=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","rFonts").att("@w","ascii",fontName).att("@w","hAnsi",fontName).up(),buildHighlight=(color="yellow")=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","highlight").att("@w","val",color).up(),buildVertAlign=(type="baseline")=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","vertAlign").att("@w","val",type).up(),buildHorizontalAlignment=horizontalAlignment=>("justify"===horizontalAlignment&&(horizontalAlignment="both"),xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","jc").att("@w","val",horizontalAlignment).up());function buildTextFormatting(vNode){switch(vNode.tagName){case"strong":case"b":return buildBold();case"em":case"i":return buildItalics();case"ins":case"u":return buildUnderline();case"strike":case"del":case"s":return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","strike").att("@w","val","true").up();case"sub":return buildVertAlign("subscript");case"sup":return buildVertAlign("superscript");case"mark":return buildHighlight();case"code":return buildHighlight("lightGray");case"pre":return buildRunFontFragment("Courier")}}function buildShading(colorCode){return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","shd").att("@w","val","clear").att("@w","fill",colorCode).up()}function buildRunProperties(attributes){const runPropertiesFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","rPr");return attributes&&attributes.constructor===Object&&Object.keys(attributes).forEach((key=>{switch(key){case"strong":runPropertiesFragment.import(buildBold());break;case"i":runPropertiesFragment.import(buildItalics());break;case"u":runPropertiesFragment.import(buildUnderline());break;case"color":attributes[key]&&runPropertiesFragment.import((colorCode=attributes[key],xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","color").att("@w","val",colorCode).up()));break;case"backgroundColor":attributes[key]&&runPropertiesFragment.import(buildShading(attributes[key]));break;case"fontSize":attributes[key]&&runPropertiesFragment.import((fontSize=attributes[key],xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","sz").att("@w","val",fontSize.toString()).up()));break;case"hyperlink":runPropertiesFragment.import(((type="Hyperlink")=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","rStyle").att("@w","val",type).up())("Hyperlink"));break;case"highlightColor":runPropertiesFragment.import(buildHighlight(attributes[key]));break;case"font":runPropertiesFragment.import(buildRunFontFragment("Courier"))}var fontSize,colorCode})),runPropertiesFragment.up(),runPropertiesFragment}function buildRun(vNode,attributes,docxDocumentInstance){const runFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","r"),runPropertiesFragment=buildRunProperties(attributes);if(isVnode(vNode)&&["span","strong","b","em","i","u","ins","strike","del","s","sub","sup","mark","blockquote","code","pre"].includes(vNode.tagName)){const textArray=[];let vNodes=[vNode];for(;vNodes.length;){const tempVNode=vNodes.shift();if(isVtext(tempVNode)&&textArray.push(tempVNode.text),isVnode(tempVNode)&&["strong","b","em","i","u","ins","strike","del","s","sub","sup","mark","code","pre"].includes(tempVNode.tagName)){const formattingFragment=buildTextFormatting(tempVNode);runPropertiesFragment.import(formattingFragment)}tempVNode.children&&tempVNode.children.length&&(vNodes=tempVNode.children.slice().concat(vNodes))}if(textArray.length){const combinedString=textArray.join("");vNode=new vtext(combinedString)}}if(runFragment.import(runPropertiesFragment),isVnode(vNode)&&"img"===vNode.tagName&&computeImageDimensions(vNode,attributes=Object.assign(Object.assign({},attributes),getPictureAttributes(docxDocumentInstance,vNode))),isVtext(vNode)){const textFragment=buildTextElement(vNode.text);runFragment.import(textFragment)}else if(attributes&&"picture"===attributes.type){const{type:type,inlineOrAnchored:inlineOrAnchored}=attributes,imageFragment=buildDrawing(inlineOrAnchored,type,__rest(attributes,["type","inlineOrAnchored"]));runFragment.import(imageFragment)}else if(isVnode(vNode)&&"br"===vNode.tagName){const lineBreakFragment=function(type="textWrapping"){return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","br").att("@w","type",type).up()}();runFragment.import(lineBreakFragment)}return runFragment.up(),runFragment}const rgbRegex=/rgb\((\d+),\s*([\d.]+),\s*([\d.]+)\)/i,hslRegex=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/i,hexRegex=/#([0-9A-F]{6})/i,hex3Regex=/#([0-9A-F])([0-9A-F])([0-9A-F])/i,rgbToHex=(red,green,blue)=>[red,green,blue].map((x=>1===(x=parseInt(x).toString(16)).length?`0${x}`:x)).join("");function fixupColorCode(colorCodeString){if(Object.prototype.hasOwnProperty.call(colorNames__default.default,colorCodeString.toLowerCase())){const[red,green,blue]=colorNames__default.default[colorCodeString.toLowerCase()];return rgbToHex(red,green,blue)}if(rgbRegex.test(colorCodeString)){const matchedParts=colorCodeString.match(rgbRegex),red=matchedParts[1],green=matchedParts[2],blue=matchedParts[3];return rgbToHex(red,green,blue)}if(hslRegex.test(colorCodeString)){const matchedParts=colorCodeString.match(hslRegex);return((hue,saturation,luminosity)=>{let red,green,blue;if(hue/=360,luminosity/=100,0==(saturation/=100))red=green=blue=luminosity;else{const hue2rgb=(p,q,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p),q=luminosity<.5?luminosity*(1+saturation):luminosity+saturation-luminosity*saturation,p=2*luminosity-q;red=hue2rgb(p,q,hue+1/3),green=hue2rgb(p,q,hue),blue=hue2rgb(p,q,hue-1/3)}return[red,green,blue].map((x=>{const hex=Math.round(255*x).toString(16);return 1===hex.length?`0${hex}`:hex})).join("")})(matchedParts[1],matchedParts[2],matchedParts[3])}if(hexRegex.test(colorCodeString)){return colorCodeString.match(hexRegex)[1]}if(hex3Regex.test(colorCodeString)){const matchedParts=colorCodeString.match(hex3Regex);return((red,green,blue)=>[red,green,blue].map((x=>`${x}${x}`)).join(""))(matchedParts[1],matchedParts[2],matchedParts[3])}return"000000"}function fixupFontSize$1(fontSizeString){if(pointRegex.test(fontSizeString)){const matchedParts=fontSizeString.match(pointRegex);return pointToHIP(matchedParts[1])}if(pixelRegex.test(fontSizeString)){const matchedParts=fontSizeString.match(pixelRegex);return pixelToHIP(matchedParts[1])}}function buildRunOrRuns(vNode,attributes,docxDocumentInstance){if(isVnode(vNode)&&"span"===vNode.tagName){const runFragments=[];for(let index=0;index<vNode.children.length;index++){const childVNode=vNode.children[index],modifiedAttributes=Object.assign({},attributes);isVnode(vNode)&&vNode.properties&&vNode.properties.style&&(vNode.properties.style.color&&!colorlessColors.includes(vNode.properties.style.color)&&(modifiedAttributes.color=fixupColorCode(vNode.properties.style.color)),vNode.properties.style["background-color"]&&!colorlessColors.includes(vNode.properties.style["background-color"])&&(modifiedAttributes.backgroundColor=fixupColorCode(vNode.properties.style["background-color"])),vNode.properties.style["font-size"]&&(modifiedAttributes.fontSize=fixupFontSize$1(vNode.properties.style["font-size"]))),runFragments.push(buildRun(childVNode,modifiedAttributes,docxDocumentInstance))}return runFragments}return buildRun(vNode,attributes,docxDocumentInstance)}function buildRunOrHyperLink(vNode,attributes,docxDocumentInstance){if(isVnode(vNode)&&"a"===vNode.tagName){const relationshipId=docxDocumentInstance.createDocumentRelationships(docxDocumentInstance.relationshipFilename,"hyperlink",vNode.properties&&vNode.properties.href?vNode.properties.href:""),hyperlinkFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w,r:namespaces_r}}).ele("@w","hyperlink").att("@r","id",`rId${relationshipId}`),modifiedAttributes=Object.assign({},attributes);modifiedAttributes.hyperlink=!0;const runFragments=buildRunOrRuns(vNode.children[0],modifiedAttributes,docxDocumentInstance);if(Array.isArray(runFragments))for(let index=0;index<runFragments.length;index++){const runFragment=runFragments[index];hyperlinkFragment.import(runFragment)}else hyperlinkFragment.import(runFragments);return hyperlinkFragment.up(),hyperlinkFragment}return buildRunOrRuns(vNode,attributes,docxDocumentInstance)}function buildBorder(borderSide="top",borderSize=0,borderSpacing=0,borderColor=fixupColorCode("black"),borderStroke="single"){return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w",borderSide).att("@w","val",borderStroke).att("@w","sz",borderSize.toString()).att("@w","space",borderSpacing.toString()).att("@w","color",borderColor).up()}function buildParagraphProperties(attributes){const paragraphPropertiesFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","pPr");if(attributes&&attributes.constructor===Object){Object.keys(attributes).forEach((key=>{switch(key){case"numbering":{const{levelId:levelId,numberingId:numberingId}=attributes[key],numberingPropertiesFragment=((levelId,numberingId)=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","numPr").ele("@w","ilvl").att("@w","val",String(levelId)).up().ele("@w","numId").att("@w","val",String(numberingId)).up().up())(levelId,numberingId);paragraphPropertiesFragment.import(numberingPropertiesFragment),delete attributes.numbering;break}case"textAlign":{const horizontalAlignmentFragment=buildHorizontalAlignment(attributes[key]);paragraphPropertiesFragment.import(horizontalAlignmentFragment),delete attributes.textAlign;break}case"backgroundColor":if("block"===attributes.display){const shadingFragment=buildShading(attributes[key]);paragraphPropertiesFragment.import(shadingFragment);const paragraphBorderFragment=function(){const paragraphBorderFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","pBdr"),bordersObject=cloneDeep(paragraphBordersObject);return Object.keys(bordersObject).forEach((borderName=>{if(bordersObject[borderName]){const{size:size,spacing:spacing,color:color}=bordersObject[borderName],borderFragment=buildBorder(borderName,size,spacing,color);paragraphBorderFragment.import(borderFragment)}})),paragraphBorderFragment.up(),paragraphBorderFragment}();paragraphPropertiesFragment.import(paragraphBorderFragment),delete attributes.backgroundColor}break;case"paragraphStyle":{const pStyleFragment=((style="Normal")=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","pStyle").att("@w","val",style).up())(attributes.paragraphStyle);paragraphPropertiesFragment.import(pStyleFragment),delete attributes.paragraphStyle;break}case"indentation":{const indentationFragment=(({left:left,right:right})=>{const indentationFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","ind");return left&&indentationFragment.att("@w","left",left),right&&indentationFragment.att("@w","right",right),indentationFragment.up(),indentationFragment})(attributes[key]);paragraphPropertiesFragment.import(indentationFragment),delete attributes.indentation;break}}}));const spacingFragment=((lineSpacing,beforeSpacing,afterSpacing)=>{const spacingFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","spacing");return lineSpacing&&spacingFragment.att("@w","line",lineSpacing),beforeSpacing&&spacingFragment.att("@w","before",beforeSpacing),afterSpacing&&spacingFragment.att("@w","after",afterSpacing),spacingFragment.att("@w","lineRule","auto").up(),spacingFragment})(attributes.lineHeight,attributes.beforeSpacing,attributes.afterSpacing);delete attributes.lineHeight,delete attributes.beforeSpacing,delete attributes.afterSpacing,paragraphPropertiesFragment.import(spacingFragment)}return paragraphPropertiesFragment.up(),paragraphPropertiesFragment}function fixupLineHeight(lineHeight,fontSize){if(isNaN(lineHeight))return 240;if(fontSize){return HIPValue=+lineHeight*fontSize,Math.round(10*HIPValue)}return 240*+lineHeight;var HIPValue}function fixupMargin(marginString){if(pointRegex.test(marginString)){const matchedParts=marginString.match(pointRegex);return pointToTWIP(matchedParts[1])}if(pixelRegex.test(marginString)){const matchedParts=marginString.match(pixelRegex);return pixelToTWIP(matchedParts[1])}}function buildParagraph(vNode,attributes,docxDocumentInstance){if(isVtext(vNode)&&" "===vNode.text)return console.trace("space node"),xmlbuilder2.fragment();const paragraphFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","p"),modifiedAttributes=Object.assign({},attributes);if(isVnode(vNode)&&vNode.properties&&vNode.properties.style){if(vNode.properties.style.color&&!colorlessColors.includes(vNode.properties.style.color)&&(modifiedAttributes.color=fixupColorCode(vNode.properties.style.color)),vNode.properties.style["background-color"]&&!colorlessColors.includes(vNode.properties.style["background-color"])&&(modifiedAttributes.backgroundColor=fixupColorCode(vNode.properties.style["background-color"])),vNode.properties.style["vertical-align"]&&verticalAlignValues.includes(vNode.properties.style["vertical-align"])&&(modifiedAttributes.verticalAlign=vNode.properties.style["vertical-align"]),vNode.properties.style["text-align"]&&["left","right","center","justify"].includes(vNode.properties.style["text-align"])&&(modifiedAttributes.textAlign=vNode.properties.style["text-align"]),vNode.properties.style["font-weight"]&&"bold"===vNode.properties.style["font-weight"]&&(modifiedAttributes.strong=vNode.properties.style["font-weight"]),vNode.properties.style["font-size"]&&(modifiedAttributes.fontSize=fixupFontSize$1(vNode.properties.style["font-size"])),vNode.properties.style["line-height"]&&(modifiedAttributes.lineHeight=fixupLineHeight(vNode.properties.style["line-height"],vNode.properties.style["font-size"]?fixupFontSize$1(vNode.properties.style["font-size"]):null)),vNode.properties.style["margin-left"]||vNode.properties.style["margin-right"]){const leftMargin=fixupMargin(vNode.properties.style["margin-left"]),rightMargin=fixupMargin(vNode.properties.style["margin-right"]),indentation={};leftMargin&&(indentation.left=leftMargin),rightMargin&&(indentation.right=rightMargin),(leftMargin||rightMargin)&&(modifiedAttributes.indentation=indentation)}vNode.properties.style.display&&(modifiedAttributes.display=vNode.properties.style.display)}isVnode(vNode)&&"blockquote"===vNode.tagName?(modifiedAttributes.indentation={left:284},modifiedAttributes.textAlign="justify"):isVnode(vNode)&&"code"===vNode.tagName?modifiedAttributes.highlightColor="lightGray":isVnode(vNode)&&"pre"===vNode.tagName&&(modifiedAttributes.font="Courier");const paragraphPropertiesFragment=buildParagraphProperties(modifiedAttributes);if(paragraphFragment.import(paragraphPropertiesFragment),isVnode(vNode)&&vNodeHasChildren(vNode))if(["span","strong","b","em","i","u","ins","strike","del","s","sub","sup","mark","a","code","pre"].includes(vNode.tagName)){const runOrHyperlinkFragments=buildRunOrHyperLink(vNode,modifiedAttributes,docxDocumentInstance);if(Array.isArray(runOrHyperlinkFragments))for(let iteratorIndex=0;iteratorIndex<runOrHyperlinkFragments.length;iteratorIndex++){const runOrHyperlinkFragment=runOrHyperlinkFragments[iteratorIndex];paragraphFragment.import(runOrHyperlinkFragment)}else paragraphFragment.import(runOrHyperlinkFragments)}else if("blockquote"===vNode.tagName){const runFragment=buildRun(vNode,attributes);paragraphFragment.import(runFragment)}else for(let index=0;index<vNode.children.length;index++){const runOrHyperlinkFragments=buildRunOrHyperLink(vNode.children[index],modifiedAttributes,docxDocumentInstance);if(Array.isArray(runOrHyperlinkFragments))for(let iteratorIndex=0;iteratorIndex<runOrHyperlinkFragments.length;iteratorIndex++){const runOrHyperlinkFragment=runOrHyperlinkFragments[iteratorIndex];paragraphFragment.import(runOrHyperlinkFragment)}else paragraphFragment.import(runOrHyperlinkFragments)}else{isVnode(vNode)&&"img"===vNode.tagName&&computeImageDimensions(vNode,modifiedAttributes);const runFragments=buildRunOrRuns(vNode,modifiedAttributes,docxDocumentInstance);if(Array.isArray(runFragments))for(let index=0;index<runFragments.length;index++){const runFragment=runFragments[index];paragraphFragment.import(runFragment)}else paragraphFragment.import(runFragments)}return paragraphFragment.up(),paragraphFragment}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&"[object Symbol]"==baseGetTag(value)}var symbolProto=Symbol?Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError("Expected a function");var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache;var func,result,cache,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=(func=function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)})),result},result=memoize(func,(function(key){return 500===cache.size&&cache.clear(),key})),cache=result.cache,result);function castPath(value,object){return isArray(value)?value:function(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object)}(value,object)?[value]:stringToPath(function(value){return null==value?"":baseToString(value)}(value))}function toKey(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result}function get(object,path,defaultValue){var result=null==object?void 0:function(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}(object,path);return void 0===result?defaultValue:result}function buildImage(docxDocumentInstance,vNode,maximumWidth=null){const attrs=getPictureAttributes(docxDocumentInstance,vNode,maximumWidth);if(attrs){return buildParagraph(vNode,attrs,docxDocumentInstance)}}function getPictureAttributes(docxDocumentInstance,vNode,maximumWidth=null){let response=null;try{try{const decoded=decodeURIComponent(get(vNode,"properties.src"));console.log("decoded",decoded.substring(0,100)),response=docxDocumentInstance.createMediaFile(decoded)}catch(error){console.warn("error creating media",error)}if(response){docxDocumentInstance.zip.folder("word").folder("media").file(response.fileNameWithExtension,Buffer.from(response.fileContent,"base64"),{createFolders:!1});const relationshipId=response.fileNameWithExtension.replace(/[^0-9a-zA-Z]/g,"");docxDocumentInstance.createDocumentRelationships(docxDocumentInstance.relationshipFilename,"image",`media/${response.fileNameWithExtension}`,"Internal",relationshipId);const imageBuffer=Buffer.from(response.fileContent,"base64"),imageProperties=sizeOf(imageBuffer);return Object.assign(Object.assign({type:"picture",inlineOrAnchored:!0,relationshipId:relationshipId},response),{maximumWidth:maximumWidth||docxDocumentInstance.availableDocumentSpace,originalWidth:imageProperties.width,originalHeight:imageProperties.height})}}catch(err){console.log("error building image")}}function buildList(vNode,docxDocumentInstance,xmlFragment){let vNodeObjects=[{node:vNode,level:0,type:vNode.tagName,numberingId:docxDocumentInstance.createNumbering(vNode.tagName,vNode.properties)}];for(;vNodeObjects.length;){const tempVNodeObject=vNodeObjects.shift();if(isVtext(tempVNodeObject.node)||isVnode(tempVNodeObject.node)&&!["ul","ol","li"].includes(tempVNodeObject.node.tagName)){const paragraphFragment=buildParagraph(tempVNodeObject.node,{numbering:{levelId:tempVNodeObject.level,numberingId:tempVNodeObject.numberingId}},docxDocumentInstance);xmlFragment.import(paragraphFragment)}if(tempVNodeObject.node.children&&tempVNodeObject.node.children.length&&["ul","ol","li"].includes(tempVNodeObject.node.tagName)){vNodeObjects=tempVNodeObject.node.children.reduce(((accumulator,childVNode)=>{if(["ul","ol"].includes(childVNode.tagName))accumulator.push({node:childVNode,level:tempVNodeObject.level+1,type:childVNode.tagName,numberingId:docxDocumentInstance.createNumbering(childVNode.tagName,childVNode.properties)});else if(accumulator.length>0&&isVnode(accumulator[accumulator.length-1].node)&&"p"===accumulator[accumulator.length-1].node.tagName.toLowerCase())accumulator[accumulator.length-1].node.children.push(childVNode);else{const paragraphVNode=new vnode("p",null,isVtext(childVNode)?[childVNode]:isVnode(childVNode)?"li"===childVNode.tagName.toLowerCase()?[...childVNode.children]:[childVNode]:[]);accumulator.push({node:isVnode(childVNode)?"li"===childVNode.tagName.toLowerCase()?childVNode:"p"!==childVNode.tagName.toLowerCase()?paragraphVNode:childVNode:paragraphVNode,level:tempVNodeObject.level,type:tempVNodeObject.type,numberingId:tempVNodeObject.numberingId})}return accumulator}),[]).concat(vNodeObjects)}}return[]}function buildTableCellProperties(attributes){const tableCellPropertiesFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tcPr");return attributes&&attributes.constructor===Object&&Object.keys(attributes).forEach((key=>{switch(key){case"backgroundColor":{const shadingFragment=buildShading(attributes[key]);tableCellPropertiesFragment.import(shadingFragment),delete attributes.backgroundColor;break}case"verticalAlign":{const verticalAlignmentFragment=("middle"===(verticalAlignment=attributes[key]).toLowerCase()&&(verticalAlignment="center"),xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","vAlign").att("@w","val",verticalAlignment).up());tableCellPropertiesFragment.import(verticalAlignmentFragment),delete attributes.verticalAlign;break}case"colSpan":{const gridSpanFragment=(spanValue=attributes[key],xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","gridSpan").att("@w","val",spanValue).up());tableCellPropertiesFragment.import(gridSpanFragment),delete attributes.colSpan;break}case"tableCellBorder":{const tableCellBorderFragment=buildTableCellBorders(attributes[key]);tableCellPropertiesFragment.import(tableCellBorderFragment),delete attributes.tableCellBorder;break}case"rowSpan":{const verticalMergeFragment=function(verticalMerge="continue"){return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","vMerge").att("@w","val",verticalMerge).up()}(attributes[key]);tableCellPropertiesFragment.import(verticalMergeFragment),delete attributes.rowSpan;break}}var spanValue,verticalAlignment})),tableCellPropertiesFragment.up(),tableCellPropertiesFragment}const buildTableCellBorders=tableCellBorder=>{const tableCellBordersFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tcBorders"),{color:color,stroke:stroke}=tableCellBorder,borders=__rest(tableCellBorder,["color","stroke"]);return Object.keys(borders).forEach((border=>{if(tableCellBorder[border]){const borderFragment=buildBorder(border,tableCellBorder[border],0,color,stroke);tableCellBordersFragment.import(borderFragment)}})),tableCellBordersFragment.up(),tableCellBordersFragment};function cssBorderParser(borderString){let[size,stroke,color]=borderString.split(" ");if(pointRegex.test(size)){const matchedParts=size.match(pointRegex);size=pointToEIP(matchedParts[1])}else if(pixelRegex.test(size)){const matchedParts=size.match(pixelRegex);pixelValue=matchedParts[1],size=pointToEIP(pixelToPoint(pixelValue))}var pixelValue;return stroke=stroke&&["dashed","dotted","double"].includes(stroke)?stroke:"single",color=color&&fixupColorCode(color).toUpperCase(),[size,stroke,color]}function buildTableCell(vNode,attributes,rowSpanMap,columnIndex,docxDocumentInstance){const tableCellFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tc"),modifiedAttributes=Object.assign({},attributes);if(isVnode(vNode)&&vNode.properties){if(vNode.properties.rowSpan)rowSpanMap.set(columnIndex.index,{rowSpan:vNode.properties.rowSpan-1,colSpan:0}),modifiedAttributes.rowSpan="restart";else{const previousSpanObject=rowSpanMap.get(columnIndex.index);rowSpanMap.set(columnIndex.index,Object.assign({},previousSpanObject,{rowSpan:0,colSpan:previousSpanObject&&previousSpanObject.colSpan||0}))}if(vNode.properties.colSpan||vNode.properties.style&&vNode.properties.style["column-span"]){modifiedAttributes.colSpan=vNode.properties.colSpan||vNode.properties.style&&vNode.properties.style["column-span"];const previousSpanObject=rowSpanMap.get(columnIndex.index);rowSpanMap.set(columnIndex.index,Object.assign({},previousSpanObject,{colSpan:parseInt(modifiedAttributes.colSpan)||0})),columnIndex.index+=parseInt(modifiedAttributes.colSpan)-1}vNode.properties.style&&(vNode.properties.style.color&&!colorlessColors.includes(vNode.properties.style.color)&&(modifiedAttributes.color=fixupColorCode(vNode.properties.style.color)),vNode.properties.style["background-color"]&&!colorlessColors.includes(vNode.properties.style["background-color"])&&(modifiedAttributes.backgroundColor=fixupColorCode(vNode.properties.style["background-color"])),vNode.properties.style["vertical-align"]&&verticalAlignValues.includes(vNode.properties.style["vertical-align"])&&(modifiedAttributes.verticalAlign=vNode.properties.style["vertical-align"]),fixupTableCellBorder(vNode,modifiedAttributes))}const tableCellPropertiesFragment=buildTableCellProperties(modifiedAttributes);if(tableCellFragment.import(tableCellPropertiesFragment),vNodeHasChildren(vNode))for(let index=0;index<vNode.children.length;index++){const childVNode=vNode.children[index];if(isVnode(childVNode)&&"img"===childVNode.tagName){const imageFragment=buildImage(docxDocumentInstance,childVNode,modifiedAttributes.maximumWidth);imageFragment&&tableCellFragment.import(imageFragment)}else if(isVnode(childVNode)&&"figure"===childVNode.tagName){if(vNodeHasChildren(childVNode))for(let iteratorIndex=0;iteratorIndex<childVNode.children.length;iteratorIndex++){const grandChildVNode=childVNode.children[iteratorIndex];if("img"===grandChildVNode.tagName){const imageFragment=buildImage(docxDocumentInstance,grandChildVNode,modifiedAttributes.maximumWidth);imageFragment&&tableCellFragment.import(imageFragment)}}}else if(isVnode(childVNode)&&["ul","ol"].includes(childVNode.tagName))vNodeHasChildren(childVNode)&&buildList(childVNode,docxDocumentInstance,tableCellFragment);else{const paragraphFragment=buildParagraph(childVNode,modifiedAttributes,docxDocumentInstance);tableCellFragment.import(paragraphFragment)}}else{const paragraphFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","p").up();tableCellFragment.import(paragraphFragment)}return tableCellFragment.up(),tableCellFragment}const fixupTableCellBorder=(vNode,attributes)=>{if(Object.prototype.hasOwnProperty.call(vNode.properties.style,"border"))if("none"===vNode.properties.style.border||0===vNode.properties.style.border)attributes.tableCellBorder={};else{const[borderSize,borderStroke,borderColor]=cssBorderParser(vNode.properties.style.border);attributes.tableCellBorder={top:borderSize,left:borderSize,bottom:borderSize,right:borderSize,color:borderColor,stroke:borderStroke}}if(vNode.properties.style["border-top"]&&"0"===vNode.properties.style["border-top"])attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{top:0});else if(vNode.properties.style["border-top"]&&"0"!==vNode.properties.style["border-top"]){const[borderSize,borderStroke,borderColor]=cssBorderParser(vNode.properties.style["border-top"]);attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{top:borderSize,color:borderColor,stroke:borderStroke})}if(vNode.properties.style["border-left"]&&"0"===vNode.properties.style["border-left"])attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{left:0});else if(vNode.properties.style["border-left"]&&"0"!==vNode.properties.style["border-left"]){const[borderSize,borderStroke,borderColor]=cssBorderParser(vNode.properties.style["border-left"]);attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{left:borderSize,color:borderColor,stroke:borderStroke})}if(vNode.properties.style["border-bottom"]&&"0"===vNode.properties.style["border-bottom"])attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{bottom:0});else if(vNode.properties.style["border-bottom"]&&"0"!==vNode.properties.style["border-bottom"]){const[borderSize,borderStroke,borderColor]=cssBorderParser(vNode.properties.style["border-bottom"]);attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{bottom:borderSize,color:borderColor,stroke:borderStroke})}if(vNode.properties.style["border-right"]&&"0"===vNode.properties.style["border-right"])attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{right:0});else if(vNode.properties.style["border-right"]&&"0"!==vNode.properties.style["border-right"]){const[borderSize,borderStroke,borderColor]=cssBorderParser(vNode.properties.style["border-right"]);attributes.tableCellBorder=Object.assign(Object.assign({},attributes.tableCellBorder),{right:borderSize,color:borderColor,stroke:borderStroke})}};function buildRowSpanCell(rowSpanMap,columnIndex,attributes){const rowSpanCellFragments=[];let spanObject=rowSpanMap.get(columnIndex.index);for(;spanObject&&spanObject.rowSpan;){const rowSpanCellFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tc"),tableCellPropertiesFragment=buildTableCellProperties(Object.assign(Object.assign({},attributes),{rowSpan:"continue",colSpan:spanObject.colSpan?spanObject.colSpan:0}));rowSpanCellFragment.import(tableCellPropertiesFragment);const paragraphFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","p").up();rowSpanCellFragment.import(paragraphFragment),rowSpanCellFragment.up(),rowSpanCellFragments.push(rowSpanCellFragment),spanObject.rowSpan-1==0?rowSpanMap.delete(columnIndex.index):rowSpanMap.set(columnIndex.index,{rowSpan:spanObject.rowSpan-1,colSpan:spanObject.colSpan||0}),columnIndex.index+=spanObject.colSpan||1,spanObject=rowSpanMap.get(columnIndex.index)}return rowSpanCellFragments}function buildTableRowProperties(attributes){const tableRowPropertiesFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","trPr");return attributes&&attributes.constructor===Object&&Object.keys(attributes).forEach((key=>{switch(key){case"tableRowHeight":{const tableRowHeightFragment=(tableRowHeight=attributes[key],xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","trHeight").att("@w","val",tableRowHeight).att("@w","hRule","atLeast").up());tableRowPropertiesFragment.import(tableRowHeightFragment),delete attributes.tableRowHeight;break}case"rowCantSplit":if(attributes.rowCantSplit){const cantSplitFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","cantSplit").up();tableRowPropertiesFragment.import(cantSplitFragment),delete attributes.rowCantSplit}}var tableRowHeight})),tableRowPropertiesFragment.up(),tableRowPropertiesFragment}function buildTableRow(vNode,attributes,rowSpanMap,docxDocumentInstance){const tableRowFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tr"),modifiedAttributes=Object.assign({},attributes);isVnode(vNode)&&vNode.properties&&((vNode.properties.style&&vNode.properties.style.height||vNode.children[0]&&isVnode(vNode.children[0])&&vNode.children[0].properties.style&&vNode.children[0].properties.style.height)&&(modifiedAttributes.tableRowHeight=function(rowHeightString){if(pointRegex.test(rowHeightString)){const matchedParts=rowHeightString.match(pointRegex);return pointToTWIP(matchedParts[1])}if(pixelRegex.test(rowHeightString)){const matchedParts=rowHeightString.match(pixelRegex);return pixelToTWIP(matchedParts[1])}}(vNode.properties.style&&vNode.properties.style.height||(vNode.children[0]&&isVnode(vNode.children[0])&&vNode.children[0].properties.style&&vNode.children[0].properties.style.height?vNode.children[0].properties.style.height:void 0))),vNode.properties.style&&fixupTableCellBorder(vNode,modifiedAttributes));const tableRowPropertiesFragment=buildTableRowProperties(modifiedAttributes);tableRowFragment.import(tableRowPropertiesFragment);const columnIndex={index:0};if(vNodeHasChildren(vNode)){const tableColumns=vNode.children.filter((childVNode=>["td","th"].includes(childVNode.tagName))),columnWidth=docxDocumentInstance.availableDocumentSpace/tableColumns.length;for(let index=0;index<vNode.children.length;index++){const childVNode=vNode.children[index];if(["td","th"].includes(childVNode.tagName)){const rowSpanCellFragments=buildRowSpanCell(rowSpanMap,columnIndex,modifiedAttributes);if(Array.isArray(rowSpanCellFragments))for(let iteratorIndex=0;iteratorIndex<rowSpanCellFragments.length;iteratorIndex++){const rowSpanCellFragment=rowSpanCellFragments[iteratorIndex];tableRowFragment.import(rowSpanCellFragment)}const tableCellFragment=buildTableCell(childVNode,Object.assign(Object.assign({},modifiedAttributes),{maximumWidth:columnWidth}),rowSpanMap,columnIndex,docxDocumentInstance);columnIndex.index++,tableRowFragment.import(tableCellFragment)}}}if(columnIndex.index<rowSpanMap.size){const rowSpanCellFragments=buildRowSpanCell(rowSpanMap,columnIndex,modifiedAttributes);if(Array.isArray(rowSpanCellFragments))for(let iteratorIndex=0;iteratorIndex<rowSpanCellFragments.length;iteratorIndex++){const rowSpanCellFragment=rowSpanCellFragments[iteratorIndex];tableRowFragment.import(rowSpanCellFragment)}}return tableRowFragment.up(),tableRowFragment}const buildTableBorders=tableBorder=>{const tableBordersFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tblBorders"),{color:color,stroke:stroke}=tableBorder,borders=__rest(tableBorder,["color","stroke"]);return Object.keys(borders).forEach((border=>{if(borders[border]){const borderFragment=buildBorder(border,borders[border],0,color,stroke);tableBordersFragment.import(borderFragment)}})),tableBordersFragment.up(),tableBordersFragment},buildTableCellSpacing=(cellSpacing=0)=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tblCellSpacing").att("@w","w",cellSpacing.toString()).att("@w","type","dxa").up(),buildTableWidth=tableWidth=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tblW").att("@w","type","dxa").att("@w","w",String(tableWidth)).up(),buildTableCellMargins=margin=>{const tableCellMarFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tblCellMar");return["top","bottom"].forEach((side=>{const marginFragment=buildCellMargin(side,margin/2);tableCellMarFragment.import(marginFragment)})),["left","right"].forEach((side=>{const marginFragment=buildCellMargin(side,margin);tableCellMarFragment.import(marginFragment)})),tableCellMarFragment},buildCellMargin=(side,margin)=>xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w",side).att("@w","type","dxa").att("@w","w",String(margin)).up();function buildTableGridCol(gridWidth){return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","gridCol").att("@w","w",String(gridWidth))}function buildTableGridFromTableRow(vNode,attributes){const tableGridFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tblGrid");if(vNodeHasChildren(vNode)){const numberOfGridColumns=vNode.children.reduce(((accumulator,childVNode)=>{const colSpan=childVNode.properties.colSpan||childVNode.properties.style&&childVNode.properties.style["column-span"];return accumulator+(colSpan?parseInt(colSpan):1)}),0),gridWidth=attributes.maximumWidth/numberOfGridColumns;for(let index=0;index<numberOfGridColumns;index++){const tableGridColFragment=buildTableGridCol(gridWidth);tableGridFragment.import(tableGridColFragment)}}return tableGridFragment.up(),tableGridFragment}function buildTableGrid(vNode,attributes){const tableGridFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tblGrid");if(vNodeHasChildren(vNode)){const gridColumns=vNode.children.filter((childVNode=>"col"===childVNode.tagName)),gridWidth=attributes.maximumWidth/gridColumns.length;for(let index=0;index<gridColumns.length;index++){const tableGridColFragment=buildTableGridCol(gridWidth);tableGridFragment.import(tableGridColFragment)}}return tableGridFragment.up(),tableGridFragment}function buildTable(vNode,attributes,docxDocumentInstance){const tableFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tbl"),modifiedAttributes=Object.assign({},attributes);if(isVnode(vNode)&&vNode.properties){const tableAttributes=vNode.properties.attributes||{},tableStyles=vNode.properties.style||{},tableBorders={},tableCellBorders={};let minimumWidth,maximumWidth,width,[borderSize,borderStrike,borderColor]=[2,"single","000000"];if(isNaN(tableAttributes.border)||(borderSize=parseInt(tableAttributes.border,10)),tableStyles.border){const[cssSize,cssStroke,cssColor]=cssBorderParser(tableStyles.border);borderSize=cssSize||borderSize,borderColor=cssColor||borderColor,borderStrike=cssStroke||borderStrike}if(tableBorders.top=borderSize,tableBorders.bottom=borderSize,tableBorders.left=borderSize,tableBorders.right=borderSize,tableBorders.stroke=borderStrike,tableBorders.color=borderColor,"collapse"===tableStyles["border-collapse"]?(tableBorders.insideV=borderSize,tableBorders.insideH=borderSize):(tableBorders.insideV=0,tableBorders.insideH=0,tableCellBorders.top=1,tableCellBorders.bottom=1,tableCellBorders.left=1,tableCellBorders.right=1),modifiedAttributes.tableBorder=tableBorders,modifiedAttributes.tableCellSpacing=0,Object.keys(tableCellBorders).length&&(modifiedAttributes.tableCellBorder=tableCellBorders),pixelRegex.test(tableStyles["min-width"]))minimumWidth=pixelToTWIP(tableStyles["min-width"].match(pixelRegex)[1]);else if(percentageRegex.test(tableStyles["min-width"])){const percentageValue=tableStyles["min-width"].match(percentageRegex)[1];minimumWidth=Math.round(percentageValue/100*attributes.maximumWidth)}if(pixelRegex.test(tableStyles["max-width"]))pixelRegex.lastIndex=0,maximumWidth=pixelToTWIP(tableStyles["max-width"].match(pixelRegex)[1]);else if(percentageRegex.test(tableStyles["max-width"])){percentageRegex.lastIndex=0;const percentageValue=tableStyles["max-width"].match(percentageRegex)[1];maximumWidth=Math.round(percentageValue/100*attributes.maximumWidth)}if(pixelRegex.test(tableStyles.width))pixelRegex.lastIndex=0,width=pixelToTWIP(tableStyles.width.match(pixelRegex)[1]);else if(percentageRegex.test(tableStyles.width)){percentageRegex.lastIndex=0;const percentageValue=tableStyles.width.match(percentageRegex)[1];width=Math.round(percentageValue/100*attributes.maximumWidth)}width?(modifiedAttributes.width=width,maximumWidth&&(modifiedAttributes.width=Math.min(modifiedAttributes.width,maximumWidth)),minimumWidth&&(modifiedAttributes.width=Math.max(modifiedAttributes.width,minimumWidth))):minimumWidth&&(modifiedAttributes.width=minimumWidth),modifiedAttributes.width&&(modifiedAttributes.width=Math.min(modifiedAttributes.width,attributes.maximumWidth))}const tablePropertiesFragment=function(attributes){const tablePropertiesFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","tblPr");attributes&&attributes.constructor===Object&&Object.keys(attributes).forEach((key=>{switch(key){case"tableBorder":{const tableBordersFragment=buildTableBorders(attributes[key]);tablePropertiesFragment.import(tableBordersFragment),delete attributes.tableBorder;break}case"tableCellSpacing":{const tableCellSpacingFragment=buildTableCellSpacing(attributes[key]);tablePropertiesFragment.import(tableCellSpacingFragment),delete attributes.tableCellSpacing;break}case"width":if(attributes[key]){const tableWidthFragment=buildTableWidth(attributes[key]);tablePropertiesFragment.import(tableWidthFragment)}delete attributes.width}}));const tableCellMarginFragment=buildTableCellMargins(160);tablePropertiesFragment.import(tableCellMarginFragment);const alignmentFragment=buildHorizontalAlignment("center");return tablePropertiesFragment.import(alignmentFragment),tablePropertiesFragment.up(),tablePropertiesFragment}(modifiedAttributes);tableFragment.import(tablePropertiesFragment);const rowSpanMap=new Map;if(vNodeHasChildren(vNode))for(let index=0;index<vNode.children.length;index++){const childVNode=vNode.children[index];if("colgroup"===childVNode.tagName){const tableGridFragment=buildTableGrid(childVNode,modifiedAttributes);tableFragment.import(tableGridFragment)}else if("thead"===childVNode.tagName)for(let iteratorIndex=0;iteratorIndex<childVNode.children.length;iteratorIndex++){const grandChildVNode=childVNode.children[iteratorIndex];if("tr"===grandChildVNode.tagName){if(0===iteratorIndex){const tableGridFragment=buildTableGridFromTableRow(grandChildVNode,modifiedAttributes);tableFragment.import(tableGridFragment)}const tableRowFragment=buildTableRow(grandChildVNode,modifiedAttributes,rowSpanMap,docxDocumentInstance);tableFragment.import(tableRowFragment)}}else if("tbody"===childVNode.tagName)for(let iteratorIndex=0;iteratorIndex<childVNode.children.length;iteratorIndex++){const grandChildVNode=childVNode.children[iteratorIndex];if("tr"===grandChildVNode.tagName){if(0===iteratorIndex){const tableGridFragment=buildTableGridFromTableRow(grandChildVNode,modifiedAttributes);tableFragment.import(tableGridFragment)}const tableRowFragment=buildTableRow(grandChildVNode,modifiedAttributes,rowSpanMap,docxDocumentInstance);tableFragment.import(tableRowFragment)}}else if("tr"===childVNode.tagName){if(0===index){const tableGridFragment=buildTableGridFromTableRow(childVNode,modifiedAttributes);tableFragment.import(tableGridFragment)}const tableRowFragment=buildTableRow(childVNode,modifiedAttributes,rowSpanMap,docxDocumentInstance);tableFragment.import(tableRowFragment)}}return tableFragment.up(),tableFragment}const convertHTML$1=HTMLToVDOM__default.default({VNode:vnode,VText:vtext});function buildPageBreak(){return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","p").ele("@w","r").ele("@w","br").att("@w","type","page").up().up().up()}function convertVTreeToXML(docxDocumentInstance,vTree,xmlFragment){if(!vTree)return xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}});if(Array.isArray(vTree)&&vTree.length)for(let index=0;index<vTree.length;index++){convertVTreeToXML(docxDocumentInstance,vTree[index],xmlFragment)}else!Array.isArray(vTree)&&isVnode(vTree)?(!function(docxDocumentInstance,vNode,xmlFragment){switch(function(vNode){return!!(vNode.properties.style&&vNode.properties.style["page-break-before"]||vNode.properties.attributes&&"page-break"==vNode.properties.attributes.class)}(vNode)&&xmlFragment.import(buildPageBreak()),vNode.tagName){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":{const headingFragment=buildParagraph(vNode,{paragraphStyle:`Heading${vNode.tagName[1]}`},docxDocumentInstance);return void xmlFragment.import(headingFragment)}case"span":case"strong":case"b":case"em":case"i":case"u":case"ins":case"strike":case"del":case"s":case"sub":case"sup":case"mark":case"p":case"a":case"blockquote":case"code":case"pre":{const paragraphFragment=buildParagraph(vNode,{},docxDocumentInstance);return void xmlFragment.import(paragraphFragment)}case"figure":if(vNodeHasChildren(vNode))for(let index=0;index<vNode.children.length;index++){const childVNode=vNode.children[index];if("table"===childVNode.tagName){const tableFragment=buildTable(childVNode,{maximumWidth:docxDocumentInstance.availableDocumentSpace,rowCantSplit:docxDocumentInstance.tableRowCantSplit},docxDocumentInstance);xmlFragment.import(tableFragment);const emptyParagraphFragment=buildParagraph(null,{},docxDocumentInstance);xmlFragment.import(emptyParagraphFragment)}else if("img"===childVNode.tagName){const imageFragment=buildImage(docxDocumentInstance,childVNode);imageFragment&&xmlFragment.import(imageFragment)}}return;case"table":{const tableFragment=buildTable(vNode,{maximumWidth:docxDocumentInstance.availableDocumentSpace,rowCantSplit:docxDocumentInstance.tableRowCantSplit},docxDocumentInstance);xmlFragment.import(tableFragment);const emptyParagraphFragment=buildParagraph(null,{},docxDocumentInstance);return void xmlFragment.import(emptyParagraphFragment)}case"ol":case"ul":return void buildList(vNode,docxDocumentInstance,xmlFragment);case"img":{const imageFragment=buildImage(docxDocumentInstance,vNode);return void(imageFragment&&xmlFragment.import(imageFragment))}case"br":{const linebreakFragment=buildParagraph(null,{},docxDocumentInstance);return void xmlFragment.import(linebreakFragment)}}if(vNodeHasChildren(vNode))for(let index=0;index<vNode.children.length;index++){const childVNode=vNode.children[index];"div"===vNode.tagName&&isVtext(childVNode)&&" "!==childVNode.text?xmlFragment.import(buildParagraph(childVNode,{},docxDocumentInstance)):convertVTreeToXML(docxDocumentInstance,childVNode,xmlFragment)}}(docxDocumentInstance,vTree,xmlFragment),(vNode=vTree).properties.style&&vNode.properties.style["page-break-after"]&&xmlFragment.import(buildPageBreak())):!Array.isArray(vTree)&&isVtext(vTree)&&(xmlFragment=buildTextElement((es=String(vTree.text),replace.call(es,ca,pe))));var es,vNode;return xmlFragment}function renderDocumentFile(docxDocumentInstance){return convertVTreeToXML(docxDocumentInstance,convertHTML$1(docxDocumentInstance.htmlString),xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}))}function generateContentTypesFragments(contentTypesXML,type,objects){objects&&Array.isArray(objects)&&objects.forEach((object=>{const contentTypesFragment=xmlbuilder2.fragment({defaultNamespace:{ele:namespaces_contentTypes}}).ele("Override").att("PartName",`/word/${type}${object[`${type}Id`]}.xml`).att("ContentType",`application/vnd.openxmlformats-officedocument.wordprocessingml.${type}+xml`).up();contentTypesXML.root().import(contentTypesFragment)}))}function generateSectionReferenceXML(documentXML,documentSectionType,objects,isEnabled){if(isEnabled&&objects&&Array.isArray(objects)&&objects.length){const xmlFragment=xmlbuilder2.fragment();objects.forEach((({relationshipId:relationshipId,type:type})=>{const objectFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w,r:namespaces_r}}).ele("@w",`${documentSectionType}Reference`).att("@r","id",`rId${relationshipId}`).att("@w","type",type).up();xmlFragment.import(objectFragment)})),documentXML.root().first().first().import(xmlFragment)}}function generateXMLString(xmlString){return xmlbuilder2.create({encoding:"UTF-8",standalone:!0},xmlString).toString({prettyPrint:!0})}function generateSectionXML(vTree,type="header"){const sectionXML=xmlbuilder2.create({encoding:"UTF-8",standalone:!0,namespaceAlias:{w:namespaces_w,ve:namespaces_ve,o:namespaces_o,r:namespaces_r,v:namespaces_v,wp:namespaces_wp,w10:namespaces_w10}}).ele("@w","header"===type?"hdr":"ftr"),XMLFragment=xmlbuilder2.fragment();convertVTreeToXML(this,vTree,XMLFragment),"footer"===type&&"p"===XMLFragment.first().node.tagName&&this.pageNumber&&XMLFragment.first().import(xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","fldSimple").att("@w","instr","PAGE").ele("@w","r").up().up()),sectionXML.root().import(XMLFragment);const referenceName="header"===type?"Header":"Footer";switch(this[`last${referenceName}Id`]+=1,type){case"header":return{type:"header",headerId:this[`last${referenceName}Id`],headerXML:sectionXML};case"footer":return{type:"footer",footerId:this[`last${referenceName}Id`],footerXML:sectionXML};default:throw new Error("invalid type, must be footer | header")}}class DocxDocument{constructor(properties){this.zip=properties.zip,this.htmlString=properties.htmlString,this.orientation=properties.orientation;const isPortraitOrientation="portrait"===this.orientation;this.width=isPortraitOrientation?12240:15840,this.height=isPortraitOrientation?15840:12240;const marginsObject=properties.margins;this.margins=marginsObject&&Object.keys(marginsObject).length?marginsObject:isPortraitOrientation?portraitMargins:landscapeMargins,this.availableDocumentSpace=this.width-this.margins.left-this.margins.right,this.title=properties.title||"",this.subject=properties.subject||"",this.creator=properties.creator||"html-to-docx",this.keywords=properties.keywords||["html-to-docx"],this.description=properties.description||"",this.lastModifiedBy=properties.lastModifiedBy||"html-to-docx",this.revision=properties.revision||1,this.createdAt=properties.createdAt||new Date,this.modifiedAt=properties.modifiedAt||new Date,this.headerType=properties.headerType||"default",this.header=properties.header||!1,this.footerType=properties.footerType||"default",this.footer=properties.footer||!1,this.font=properties.font||"Times New Roman",this.fontSize=properties.fontSize||22,this.complexScriptFontSize=properties.complexScriptFontSize||22,this.tableRowCantSplit=properties.table&&properties.table.row&&properties.table.row.cantSplit||!1,this.pageNumber=properties.pageNumber||!1,this.skipFirstHeaderFooter=properties.skipFirstHeaderFooter||!1,this.lineNumber=properties.lineNumber?properties.lineNumberOptions:null,this.lastNumberingId=0,this.lastMediaId=0,this.lastHeaderId=0,this.lastFooterId=0,this.stylesObjects=[],this.numberingObjects=[],this.relationshipFilename="document",this.relationships=[{fileName:"document",lastRelsId:4,rels:[]}],this.mediaFiles=[],this.headerObjects=[],this.footerObjects=[],this.documentXML=null,this.generateContentTypesXML=this.generateContentTypesXML.bind(this),this.generateDocumentXML=this.generateDocumentXML.bind(this),this.generateCoreXML=this.generateCoreXML.bind(this),this.generateSettingsXML=this.generateSettingsXML.bind(this),this.generateWebSettingsXML=this.generateWebSettingsXML.bind(this),this.generateStylesXML=this.generateStylesXML.bind(this),this.generateFontTableXML=this.generateFontTableXML.bind(this),this.generateThemeXML=this.generateThemeXML.bind(this),this.generateNumberingXML=this.generateNumberingXML.bind(this),this.generateRelsXML=this.generateRelsXML.bind(this),this.createMediaFile=this.createMediaFile.bind(this),this.createDocumentRelationships=this.createDocumentRelationships.bind(this),this.generateHeaderXML=this.generateHeaderXML.bind(this),this.generateFooterXML=this.generateFooterXML.bind(this),this.generateSectionXML=generateSectionXML.bind(this)}generateContentTypesXML(){const contentTypesXML$1=xmlbuilder2.create({encoding:"UTF-8",standalone:!0},'\n    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\n        <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" />\n        <Default Extension="jpeg" ContentType="image/jpeg"/>\n        <Default Extension="png" ContentType="image/png"/>\n        <Default Extension="xml" ContentType="application/xml"/>\n        <Override PartName="/_rels/.rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\n        <Override PartName="/word/_rels/document.xml.rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\n        <Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>\n        <Override PartName="/word/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/>\n        <Override PartName="/word/numbering.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml"/>\n        <Override PartName="/word/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/>\n        <Override PartName="/word/fontTable.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"/>\n        <Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/>\n        <Override PartName="/word/settings.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"/>\n        <Override PartName="/word/webSettings.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"/>\n    </Types>\n');return generateContentTypesFragments(contentTypesXML$1,"header",this.headerObjects),generateContentTypesFragments(contentTypesXML$1,"footer",this.footerObjects),contentTypesXML$1.toString({prettyPrint:!0})}generateDocumentXML(returnString=!0){const documentXML=xmlbuilder2.create({encoding:"UTF-8",standalone:!0},(width=this.width,height=this.height,orientation=this.orientation,margins=this.margins,`\n  <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <w:document\n        xmlns:a="${namespaces_a}"\n        xmlns:cdr="${namespaces_cdr}"\n        xmlns:o="${namespaces_o}"\n        xmlns:pic="${namespaces_pic}"\n        xmlns:r="${namespaces_r}"\n        xmlns:v="${namespaces_v}"\n        xmlns:ve="${namespaces_ve}"\n        xmlns:vt="${namespaces_vt}"\n        xmlns:w="${namespaces_w}"\n        xmlns:w10="${namespaces_w10}"\n        xmlns:wp="${namespaces_wp}"\n        xmlns:wne="${namespaces_wne}"\n        >\n        <w:body>\n            <w:sectPr>\n                <w:pgSz w:w="${width}" w:h="${height}" w:orient="${orientation}" />\n                <w:pgMar w:top="${margins.top}"\n                        w:right="${margins.right}"\n                        w:bottom="${margins.bottom}"\n                        w:left="${margins.left}"\n                        w:header="${margins.header}"\n                        w:footer="${margins.footer}"\n                        w:gutter="${margins.gutter}"/>\n            </w:sectPr>\n        </w:body>\n    </w:document>\n  `));var width,height,orientation,margins;if(documentXML.root().first().import(this.documentXML),generateSectionReferenceXML(documentXML,"header",this.headerObjects,this.header),generateSectionReferenceXML(documentXML,"footer",this.footerObjects,this.footer),(this.header||this.footer)&&this.skipFirstHeaderFooter&&documentXML.root().first().first().import(xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","titlePg")),this.lineNumber){const{countBy:countBy,start:start,restart:restart}=this.lineNumber;documentXML.root().first().first().import(xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","lnNumType").att("@w","countBy",countBy.toString()).att("@w","start",start.toString()).att("@w","restart",restart))}return returnString?documentXML.toString({prettyPrint:!0}):documentXML}generateCoreXML(){return generateXMLString(((title="",subject="",creator="html-to-docx",keywords=["html-to-docx"],description="",lastModifiedBy="html-to-docx",revision=1,createdAt=new Date,modifiedAt=new Date)=>`\n        <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n        <cp:coreProperties\n          xmlns:cp="${namespaces_coreProperties}"\n          xmlns:dc="${namespaces_dc}"\n          xmlns:dcterms="${namespaces_dcterms}"\n          xmlns:dcmitype="${namespaces_dcmitype}"\n          xmlns:xsi="${namespaces_xsi}"\n          >\n            <dc:title>${title}</dc:title>\n            <dc:subject>${subject}</dc:subject>\n            <dc:creator>${creator}</dc:creator>\n            ${keywords&&Array.isArray(keywords)?`<cp:keywords>${keywords.join(", ")}</cp:keywords>`:""}\n            <dc:description>${description}</dc:description>\n            <cp:lastModifiedBy>${lastModifiedBy}</cp:lastModifiedBy>\n            <cp:revision>${revision}</cp:revision>\n            <dcterms:created xsi:type="dcterms:W3CDTF">${createdAt instanceof Date?createdAt.toISOString():(new Date).toISOString()}</dcterms:created>\n            <dcterms:modified xsi:type="dcterms:W3CDTF">${modifiedAt instanceof Date?modifiedAt.toISOString():(new Date).toISOString()}</dcterms:modified>\n        </cp:coreProperties>\n    `)(this.title,this.subject,this.creator,this.keywords,this.description,this.lastModifiedBy,this.revision,this.createdAt,this.modifiedAt))}generateSettingsXML(){return generateXMLString(settingsXML)}generateWebSettingsXML(){return generateXMLString(webSettingsXML)}generateStylesXML(){return generateXMLString(((font="Times New Roman",fontSize=22,complexScriptFontSize=22)=>`\n  <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n  <w:styles xmlns:w="${namespaces_w}" xmlns:r="${namespaces_r}">\n\t<w:docDefaults>\n\t  <w:rPrDefault>\n\t\t<w:rPr>\n\t\t  <w:rFonts w:ascii="${font}" w:eastAsiaTheme="minorHAnsi" w:hAnsiTheme="minorHAnsi" w:cstheme="minorBidi" />\n\t\t  <w:sz w:val="${fontSize}" />\n\t\t  <w:szCs w:val="${complexScriptFontSize}" />\n\t\t  <w:lang w:val="en-US" w:eastAsia="en-US" w:bidi="ar-SA" />\n\t\t</w:rPr>\n\t  </w:rPrDefault>\n\t  <w:pPrDefault>\n\t\t<w:pPr>\n\t\t  <w:spacing w:after="120" w:line="240" w:lineRule="atLeast" />\n\t\t</w:pPr>\n\t  </w:pPrDefault>\n\t</w:docDefaults>\n\t<w:style w:type="character" w:styleId="Hyperlink">\n\t  <w:name w:val="Hyperlink" />\n\t  <w:rPr>\n\t\t<w:color w:val="0000FF" />\n\t\t<w:u w:val="single" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type="paragraph" w:styleId="Heading1">\n\t  <w:name w:val="heading 1" />\n\t  <w:basedOn w:val="Normal" />\n\t  <w:next w:val="Normal" />\n\t  <w:uiPriority w:val="9" />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before="480" />\n\t\t<w:outlineLvl w:val="0" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val="48" />\n\t\t<w:szCs w:val="48" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type="paragraph" w:styleId="Heading2">\n\t  <w:name w:val="heading 2" />\n\t  <w:basedOn w:val="Normal" />\n\t  <w:next w:val="Normal" />\n\t  <w:uiPriority w:val="9" />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before="360" w:after="80" />\n\t\t<w:outlineLvl w:val="1" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val="36" />\n\t\t<w:szCs w:val="36" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type="paragraph" w:styleId="Heading3">\n\t  <w:name w:val="heading 3" />\n\t  <w:basedOn w:val="Normal" />\n\t  <w:next w:val="Normal" />\n\t  <w:uiPriority w:val="9" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before="280" w:after="80" />\n\t\t<w:outlineLvl w:val="2" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val="28" />\n\t\t<w:szCs w:val="28" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type="paragraph" w:styleId="Heading4">\n\t  <w:name w:val="heading 4" />\n\t  <w:basedOn w:val="Normal" />\n\t  <w:next w:val="Normal" />\n\t  <w:uiPriority w:val="9" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before="240" w:after="40" />\n\t\t<w:outlineLvl w:val="3" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val="24" />\n\t\t<w:szCs w:val="24" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type="paragraph" w:styleId="Heading5">\n\t  <w:name w:val="heading 5" />\n\t  <w:basedOn w:val="Normal" />\n\t  <w:next w:val="Normal" />\n\t  <w:uiPriority w:val="9" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before="220" w:after="40" />\n\t\t<w:outlineLvl w:val="4" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type="paragraph" w:styleId="Heading6">\n\t  <w:name w:val="heading 6" />\n\t  <w:basedOn w:val="Normal" />\n\t  <w:next w:val="Normal" />\n\t  <w:uiPriority w:val="9" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before="200" w:after="40" />\n\t\t<w:outlineLvl w:val="5" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val="20" />\n\t\t<w:szCs w:val="20" />\n\t  </w:rPr>\n\t</w:style>\n  </w:styles>\n  `)(this.font,this.fontSize,this.complexScriptFontSize))}generateFontTableXML(){return generateXMLString(fontTableXML)}generateThemeXML(){return generateXMLString(((font="Times New Roman")=>`\n    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">\n    <a:themeElements>\n      <a:clrScheme name="Office">\n        <a:dk1>\n          <a:sysClr val="windowText" lastClr="000000"/>\n        </a:dk1>\n        <a:lt1>\n          <a:sysClr val="window" lastClr="FFFFFF"/>\n        </a:lt1>\n        <a:dk2>\n          <a:srgbClr val="44546A"/>\n        </a:dk2>\n        <a:lt2>\n          <a:srgbClr val="E7E6E6"/>\n        </a:lt2>\n        <a:accent1>\n          <a:srgbClr val="4472C4"/>\n        </a:accent1>\n        <a:accent2>\n          <a:srgbClr val="ED7D31"/>\n        </a:accent2>\n        <a:accent3>\n          <a:srgbClr val="A5A5A5"/>\n        </a:accent3>\n        <a:accent4>\n          <a:srgbClr val="FFC000"/>\n        </a:accent4>\n        <a:accent5>\n          <a:srgbClr val="5B9BD5"/>\n        </a:accent5>\n        <a:accent6>\n          <a:srgbClr val="70AD47"/>\n        </a:accent6>\n        <a:hlink>\n          <a:srgbClr val="0563C1"/>\n        </a:hlink>\n        <a:folHlink>\n          <a:srgbClr val="954F72"/>\n        </a:folHlink>\n      </a:clrScheme>\n      <a:fontScheme name="Office">\n        <a:majorFont>\n          <a:latin typeface="${font}"/>\n          <a:ea typeface="${font}"/>\n          <a:cs typeface=""/>\n        </a:majorFont>\n        <a:minorFont>\n          <a:latin typeface="${font}"/>\n          <a:ea typeface="${font}"/>\n          <a:cs typeface=""/>\n        </a:minorFont>\n      </a:fontScheme>\n      <a:fmtScheme name="Office">\n        <a:fillStyleLst>\n          <a:solidFill>\n            <a:schemeClr val="phClr"/>\n          </a:solidFill>\n          <a:gradFill rotWithShape="1">\n            <a:gsLst>\n              <a:gs pos="0">\n                <a:schemeClr val="phClr">\n                  <a:lumMod val="110000"/>\n                  <a:satMod val="105000"/>\n                  <a:tint val="67000"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos="50000">\n                <a:schemeClr val="phClr">\n                  <a:lumMod val="105000"/>\n                  <a:satMod val="103000"/>\n                  <a:tint val="73000"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos="100000">\n                <a:schemeClr val="phClr">\n                  <a:lumMod val="105000"/>\n                  <a:satMod val="109000"/>\n                  <a:tint val="81000"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang="5400000" scaled="0"/>\n          </a:gradFill>\n          <a:gradFill rotWithShape="1">\n            <a:gsLst>\n              <a:gs pos="0">\n                <a:schemeClr val="phClr">\n                  <a:satMod val="103000"/>\n                  <a:lumMod val="102000"/>\n                  <a:tint val="94000"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos="50000">\n                <a:schemeClr val="phClr">\n                  <a:satMod val="110000"/>\n                  <a:lumMod val="100000"/>\n                  <a:shade val="100000"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos="100000">\n                <a:schemeClr val="phClr">\n                  <a:lumMod val="99000"/>\n                  <a:satMod val="120000"/>\n                  <a:shade val="78000"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang="5400000" scaled="0"/>\n          </a:gradFill>\n        </a:fillStyleLst>\n        <a:lnStyleLst>\n          <a:ln w="6350" cap="flat" cmpd="sng" algn="ctr">\n            <a:solidFill>\n              <a:schemeClr val="phClr"/>\n            </a:solidFill>\n            <a:prstDash val="solid"/>\n            <a:miter lim="800000"/>\n          </a:ln>\n          <a:ln w="12700" cap="flat" cmpd="sng" algn="ctr">\n            <a:solidFill>\n              <a:schemeClr val="phClr"/>\n            </a:solidFill>\n            <a:prstDash val="solid"/>\n            <a:miter lim="800000"/>\n          </a:ln>\n          <a:ln w="19050" cap="flat" cmpd="sng" algn="ctr">\n            <a:solidFill>\n              <a:schemeClr val="phClr"/>\n            </a:solidFill>\n            <a:prstDash val="solid"/>\n            <a:miter lim="800000"/>\n          </a:ln>\n        </a:lnStyleLst>\n        <a:effectStyleLst>\n          <a:effectStyle>\n            <a:effectLst/>\n          </a:effectStyle>\n          <a:effectStyle>\n            <a:effectLst/>\n          </a:effectStyle>\n          <a:effectStyle>\n            <a:effectLst>\n              <a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0">\n                <a:srgbClr val="000000">\n                  <a:alpha val="63000"/>\n                </a:srgbClr>\n              </a:outerShdw>\n            </a:effectLst>\n          </a:effectStyle>\n        </a:effectStyleLst>\n        <a:bgFillStyleLst>\n          <a:solidFill>\n            <a:schemeClr val="phClr"/>\n          </a:solidFill>\n          <a:solidFill>\n            <a:schemeClr val="phClr">\n              <a:tint val="95000"/>\n              <a:satMod val="170000"/>\n            </a:schemeClr>\n          </a:solidFill>\n          <a:gradFill rotWithShape="1">\n            <a:gsLst>\n              <a:gs pos="0">\n                <a:schemeClr val="phClr">\n                  <a:tint val="93000"/>\n                  <a:satMod val="150000"/>\n                  <a:shade val="98000"/>\n                  <a:lumMod val="102000"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos="50000">\n                <a:schemeClr val="phClr">\n                  <a:tint val="98000"/>\n                  <a:satMod val="130000"/>\n                  <a:shade val="90000"/>\n                  <a:lumMod val="103000"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos="100000">\n                <a:schemeClr val="phClr">\n                  <a:shade val="63000"/>\n                  <a:satMod val="120000"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang="5400000" scaled="0"/>\n          </a:gradFill>\n        </a:bgFillStyleLst>\n      </a:fmtScheme>\n    </a:themeElements>\n  </a:theme>\n`)(this.font))}generateNumberingXML(){const numberingXML=xmlbuilder2.create({encoding:"UTF-8",standalone:!0},`\n        <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n        <w:numbering\n        xmlns:w="${namespaces_w}"\n        xmlns:ve="${namespaces_ve}"\n        xmlns:o="${namespaces_o}"\n        xmlns:r="${namespaces_r}"\n        xmlns:v="${namespaces_v}"\n        xmlns:wp="${namespaces_wp}"\n        xmlns:w10="${namespaces_w10}"\n        xmlns:wne="${namespaces_wne}">\n        </w:numbering>\n    `),abstractNumberingFragments=xmlbuilder2.fragment(),numberingFragments=xmlbuilder2.fragment();return this.numberingObjects.forEach((({numberingId:numberingId,type:type,properties:properties})=>{const abstractNumberingFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","abstractNum").att("@w","abstractNumId",String(numberingId));[...Array(8).keys()].forEach((level=>{const levelFragment=xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","lvl").att("@w","ilvl",level.toString()).ele("@w","start").att("@w","val","ol"===type?properties.attributes&&properties.attributes["data-start"]||1:"1").up().ele("@w","numFmt").att("@w","val","ol"===type?(listType=>{switch(listType){case"upper-roman":return"upperRoman";case"lower-roman":return"lowerRoman";case"upper-alpha":case"upper-alpha-bracket-end":return"upperLetter";case"lower-alpha":case"lower-alpha-bracket-end":return"lowerLetter";default:return"decimal"}})(properties.style&&properties.style["list-style-type"]):"bullet").up().ele("@w","lvlText").att("@w","val","ol"===type?((style,lvl)=>{if(!style)return`%${lvl+1}`;switch(style["list-style-type"]){case"upper-roman":case"lower-roman":case"upper-alpha":case"lower-alpha":case"decimal":default:return`%${lvl+1}.`;case"upper-alpha-bracket-end":case"lower-alpha-bracket-end":case"decimal-bracket-end":return`%${lvl+1})`;case"decimal-bracket":return`(%${lvl+1})`}})(properties.style,level):"").up().ele("@w","lvlJc").att("@w","val","left").up().ele("@w","pPr").ele("@w","tabs").ele("@w","tab").att("@w","val","num").att("@w","pos",(720*(level+1)).toString()).up().up().ele("@w","ind").att("@w","left",(720*(level+1)).toString()).att("@w","hanging","360").up().up().up();"ul"===type&&levelFragment.last().import(xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","rPr").ele("@w","rFonts").att("@w","ascii","Wingdings").att("@w","hAnsi","Wingdings").att("@w","hint","default").up().up()),abstractNumberingFragment.import(levelFragment)})),abstractNumberingFragment.up(),abstractNumberingFragments.import(abstractNumberingFragment),numberingFragments.import(xmlbuilder2.fragment({namespaceAlias:{w:namespaces_w}}).ele("@w","num").att("@w","numId",String(numberingId)).ele("@w","abstractNumId").att("@w","val",String(numberingId)).up().up())})),numberingXML.root().import(abstractNumberingFragments),numberingXML.root().import(numberingFragments),numberingXML.toString({prettyPrint:!0})}appendRelationships(xmlFragment,relationships){relationships.forEach((({relationshipId:relationshipId,type:type,target:target,targetMode:targetMode})=>{xmlFragment.import(xmlbuilder2.fragment({defaultNamespace:{ele:namespaces_relationship}}).ele("Relationship").att("Id",`rId${relationshipId}`).att("Type",type).att("Target",target).att("TargetMode",targetMode).up())}))}generateRelsXML(){return this.relationships.map((({fileName:fileName,rels:rels})=>{const xmlFragment=xmlbuilder2.create({encoding:"UTF-8",standalone:!0},"document"===fileName?documentRelsXML:'\n    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n\n    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n    </Relationships>\n');return this.appendRelationships(xmlFragment.root(),rels),{fileName:fileName,xmlString:xmlFragment.toString({prettyPrint:!0})}}))}createNumbering(type,properties){return this.lastNumberingId+=1,this.numberingObjects.push({numberingId:this.lastNumberingId,type:type,properties:properties}),this.lastNumberingId}createMediaFile(base64String){const matches=base64String.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/);if(3!==matches.length)throw new Error("Invalid base64 string");const base64FileContent=matches[2],fileExtension="octet-stream"===matches[1].match(/\/(.*?)$/)[1]?"png":matches[1].match(/\/(.*?)$/)[1],fileNameWithExtension=`image-${nanoid()}.${fileExtension}`;return this.lastMediaId+=1,{id:this.lastMediaId,fileContent:base64FileContent,fileNameWithExtension:fileNameWithExtension}}createDocumentRelationships(fileName="document",type,target,targetMode="External",customRelId){let relationshipType,relationshipObject=this.relationships.find((relationship=>relationship.fileName===fileName)),lastRelsId=1;switch(relationshipObject?(lastRelsId=relationshipObject.lastRelsId+1,relationshipObject.lastRelsId=lastRelsId):(relationshipObject={fileName:fileName,lastRelsId:lastRelsId,rels:[]},this.relationships.push(relationshipObject)),type){case"hyperlink":relationshipType=namespaces_hyperlinks;break;case"image":relationshipType=namespaces_images;break;case"header":relationshipType=namespaces_headers;break;case"footer":relationshipType=namespaces_footers;break;case"theme":relationshipType=namespaces_themes}return relationshipObject.rels.push({relationshipId:customRelId||lastRelsId,type:relationshipType,target:target,targetMode:targetMode}),lastRelsId}generateHeaderXML(vTree){return this.generateSectionXML(vTree,"header")}generateFooterXML(vTree){return this.generateSectionXML(vTree,"footer")}}const convertHTML=HTMLToVDOM__default.default({VNode:vnode,VText:vtext}),fixupMargins=margins=>{let normalizedMargins={};return"object"==typeof margins&&null!==margins?Object.keys(margins).forEach((key=>{if(pixelRegex.test(margins[key])){const matchedParts=margins[key].match(pixelRegex);normalizedMargins[key]=pixelToTWIP(matchedParts[1])}else if(cmRegex.test(margins[key])){const matchedParts=margins[key].match(cmRegex);normalizedMargins[key]=(cmValue=matchedParts[1],inchToTWIP((cmValue=>.3937008*cmValue)(cmValue)))}else if(inchRegex.test(margins[key])){const matchedParts=margins[key].match(inchRegex);normalizedMargins[key]=inchToTWIP(matchedParts[1])}else margins[key]?normalizedMargins[key]=margins[key]:normalizedMargins[key]=defaultDocumentOptions.margins[key];var cmValue})):normalizedMargins=null,normalizedMargins},normalizeDocumentOptions=documentOptions=>{const normalizedDocumentOptions=Object.assign({},documentOptions);return Object.keys(documentOptions).forEach((key=>{switch(key){case"margins":normalizedDocumentOptions.margins=fixupMargins(documentOptions[key]);break;case"fontSize":case"complexScriptFontSize":normalizedDocumentOptions[key]=(fontSize=>{let normalizedFontSize;if(pointRegex.test(fontSize)){const matchedParts=fontSize.match(pointRegex);normalizedFontSize=pointToHIP(matchedParts[1])}else normalizedFontSize=fontSize||null;return normalizedFontSize})(documentOptions[key])}})),normalizedDocumentOptions};function addFilesToContainer(zip,htmlString,suppliedDocumentOptions,headerHTMLString,footerHTMLString){const normalizedDocumentOptions=normalizeDocumentOptions(suppliedDocumentOptions),documentOptions=(options=defaultDocumentOptions,patch=normalizedDocumentOptions,Object.assign(Object.assign({},options),patch));var options,patch;documentOptions.header&&!headerHTMLString&&(headerHTMLString="<p></p>"),documentOptions.footer&&!footerHTMLString&&(footerHTMLString="<p></p>");const docxDocument=new DocxDocument(Object.assign({zip:zip,htmlString:htmlString},documentOptions));if(docxDocument.documentXML=renderDocumentFile(docxDocument),zip.folder("_rels").file(".rels",xmlbuilder2.create({encoding:"UTF-8",standalone:!0},relsXML).toString({prettyPrint:!0}),{createFolders:!1}),zip.folder("docProps").file("core.xml",docxDocument.generateCoreXML(),{createFolders:!1}),docxDocument.header&&headerHTMLString){const vTree=convertHTML(headerHTMLString);docxDocument.relationshipFilename="header1";const{headerId:headerId,headerXML:headerXML}=docxDocument.generateHeaderXML(vTree);docxDocument.relationshipFilename="document";const fileNameWithExt=`header${headerId}.xml`,relationshipId=docxDocument.createDocumentRelationships(docxDocument.relationshipFilename,"header",fileNameWithExt,"Internal");zip.folder("word").file(fileNameWithExt,headerXML.toString({prettyPrint:!0}),{createFolders:!1}),docxDocument.headerObjects.push({headerId:headerId,relationshipId:relationshipId,type:docxDocument.headerType})}if(docxDocument.footer&&footerHTMLString){const vTree=convertHTML(footerHTMLString);docxDocument.relationshipFilename="footer1";const{footerId:footerId,footerXML:footerXML}=docxDocument.generateFooterXML(vTree);docxDocument.relationshipFilename="document";const fileNameWithExt=`footer${footerId}.xml`,relationshipId=docxDocument.createDocumentRelationships(docxDocument.relationshipFilename,"footer",fileNameWithExt,"Internal");zip.folder("word").file(fileNameWithExt,footerXML.toString({prettyPrint:!0}),{createFolders:!1}),docxDocument.footerObjects.push({footerId:footerId,relationshipId:relationshipId,type:docxDocument.footerType})}docxDocument.createDocumentRelationships(docxDocument.relationshipFilename,"theme","theme/theme1.xml","Internal"),zip.folder("word").folder("theme").file("theme1.xml",docxDocument.generateThemeXML(),{createFolders:!1});const docxml=docxDocument.generateDocumentXML();return zip.folder("word").file("document.xml",docxml,{createFolders:!1}).file("fontTable.xml",docxDocument.generateFontTableXML(),{createFolders:!1}).file("styles.xml",docxDocument.generateStylesXML(),{createFolders:!1}).file("numbering.xml",docxDocument.generateNumberingXML(),{createFolders:!1}).file("settings.xml",docxDocument.generateSettingsXML(),{createFolders:!1}).file("webSettings.xml",docxDocument.generateWebSettingsXML(),{createFolders:!1}),addRelsToZip(zip,docxDocument),zip.file("[Content_Types].xml",docxDocument.generateContentTypesXML(),{createFolders:!1}),zip}function addRelsToZip(zip,docxDocument){const relationshipXMLs=docxDocument.generateRelsXML();relationshipXMLs&&Array.isArray(relationshipXMLs)&&relationshipXMLs.forEach((({fileName:fileName,xmlString:xmlString})=>{zip.folder("word").folder("_rels").file(`${fileName}.xml.rels`,xmlString,{createFolders:!1})}))}const minifyHTMLString=htmlString=>{try{if("string"==typeof htmlString){return htmlString.replace(/\n/g," ").replace(/\r/g," ").replace(/\r\n/g," ").replace(/[\t ]+</g," <").replace(/>[\t ]+$/g,"> ").replace(/>[\t ]+</g,"> <").replace(/\s{2,}\B/g,"")}throw new Error("invalid html string")}catch(error){return null}};exports.convertSnippetToXML=function(htmlString){const zip=new JSZip__default.default,docxDocument=new DocxDocument({htmlString:htmlString,zip:zip});docxDocument.documentXML=renderDocumentFile(docxDocument);const docXML=docxDocument.generateDocumentXML(!1),rels=docxDocument.relationships;return console.log("rels",rels[0].rels),addRelsToZip(zip,docxDocument),zip.folder("word").file("styles.xml",docxDocument.generateStylesXML(),{createFolders:!1}),{xmlString:docXML.root().first().toString().replace(/(<w:body.*?>)/,"").replace(/<\/w:body>/,""),zip:docxDocument.zip}},exports.generateContainer=async function(htmlString,headerHTMLString,documentOptions={},footerHTMLString){const zip=new JSZip__default.default;let contentHTML=htmlString,headerHTML=headerHTMLString,footerHTML=footerHTMLString;htmlString&&(contentHTML=minifyHTMLString(contentHTML)),headerHTMLString&&(headerHTML=minifyHTMLString(headerHTML)),footerHTMLString&&(footerHTML=minifyHTMLString(footerHTML)),addFilesToContainer(zip,contentHTML,documentOptions,headerHTML,footerHTML);const buffer=await zip.generateAsync({type:"arraybuffer"});if(Object.prototype.hasOwnProperty.call(global,"Blob"))return new Blob([buffer],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});if(Object.prototype.hasOwnProperty.call(global,"Buffer"))return Buffer.from(new Uint8Array(buffer));throw new Error("Add blob support using a polyfill eg https://github.com/bjornstar/blob-polyfill")},Object.defineProperty(exports,"__esModule",{value:!0})}));
//# sourceMappingURL=html-to-docx.umd.js.map
